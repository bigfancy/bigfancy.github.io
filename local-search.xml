<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>cursor</title>
    <link href="/2025/06/15/cursor/"/>
    <url>/2025/06/15/cursor/</url>
    
    <content type="html"><![CDATA[<h1 id="cursor-tips">cursor tips</h1><p>Using Cursor well = fast, clean code.</p><p>Using it wrong = AI spaghetti youâ€™ll be cleaning up all week.</p><p>Hereâ€™s how to actually use it right:</p><ol type="1"><li><p>Set 5-10 clear project rules upfront so Cursor knows yourstructure and constraints. Try /generate rules for existingcodebases.</p></li><li><p>Be specific in prompts. Spell out tech stack, behavior, andconstraints like a mini spec.</p></li><li><p>Work file by file; generate, test, and review in small, focusedchunks.</p></li><li><p>Write tests first, lock them, and generate code until all testspass.</p></li><li><p>Always review AI output and hardâ€‘fix anything that breaks, thentell Cursor to use them as examples.</p></li><li><p>Use @ file, @ folders, @ git to scope Cursorâ€™s attention to theright parts of your codebase.</p></li><li><p>Keep design docs and checklists in .cursor/ so the agent has fullcontext on what to do next.</p></li><li><p>If code is wrong, just write it yourself. Cursor learns fasterfrom edits than explanations.</p></li><li><p>Use chat history to iterate on old prompts without startingover.</p></li><li><p>Choose models intentionally. Gemini for precision, Claude forbreadth.</p></li><li><p>In new or unfamiliar stacks, paste in link to documentation. MakeCursor explain all errors and fixes line by line.</p></li></ol><p>12.Let big projects index overnight and limit context scope to keepperformance snappy.</p><p>Structure and control wins (for now)</p><p>Treat Cursor agent like a powerful junior â€” it can go far, fast, ifyou show it the way.</p><h1 id="frontend">frontend</h1><p>å‰ç«¯æŠ€æœ¯çš„çƒ­é—¨ç»„åˆ</p><p>React tailwind Montion Radix UI</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>load-test1</title>
    <link href="/2025/05/26/load-test1/"/>
    <url>/2025/05/26/load-test1/</url>
    
    <content type="html"><![CDATA[<h1 id="sauce-labs-ã¨-aws">Sauce Labs ã¨ AWS</h1><hr><h2 id="sauce-labs-ã¨-aws-è‡ªå‰ç’°å¢ƒã®æ¯”è¼ƒplaywright-å®Ÿè¡Œ">ğŸ§ª Sauce Labsã¨ AWS è‡ªå‰ç’°å¢ƒã®æ¯”è¼ƒï¼ˆPlaywright å®Ÿè¡Œï¼‰</h2><table><thead><tr><th>æ¯”è¼ƒé …ç›®</th><th>Sauce Labs</th><th>AWS è‡ªå‰æ§‹ç¯‰</th></tr></thead><tbody><tr><td>ğŸ› ï¸ è¨­å®šã®é›£æ˜“åº¦</td><td>âœ… ã™ãã«ä½¿ãˆã‚‹ã€ã»ã¼è¨­å®šä¸è¦</td><td>âŒ OSã€Nodeã€ãƒ–ãƒ©ã‚¦ã‚¶ã€Playwrightã€CI/CD ãªã©æ‰‹å‹•è¨­å®šå¿…è¦</td></tr><tr><td>ğŸ“¦ Playwright å¯¾å¿œ</td><td>âœ… Playwright å¯¾å¿œæ¸ˆã¿ã€è¤‡æ•°ãƒ–ãƒ©ã‚¦ã‚¶/ãƒãƒ¼ã‚¸ãƒ§ãƒ³é¸æŠå¯</td><td>âŒ è‡ªåˆ†ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ç®¡ç†ã™ã‚‹å¿…è¦</td></tr><tr><td>ğŸŒ OS / ãƒ–ãƒ©ã‚¦ã‚¶ã®ç¨®é¡</td><td>âœ… macOSã€Windowsã€Linuxã€Androidã€iOS ã«å¯¾å¿œ</td><td>â›” AWS ã§ã¯ iOS/macOS ã¯éå¯¾å¿œï¼ˆmacOS ã¯ EC2 Mac é™å®šï¼‰</td></tr><tr><td>ğŸ“Š ä¸¦åˆ—å®Ÿè¡Œ</td><td>âœ… ãƒ—ãƒ©ãƒ³ã«å¿œã˜ã¦è¤‡æ•°ã®ãƒ†ã‚¹ãƒˆã‚’ä¸¦åˆ—å®Ÿè¡Œå¯èƒ½</td><td>â›” ä¸¦åˆ—åŒ–ã¯è‡ªåŠ›ã§æ§‹ç¯‰ï¼ˆä¾‹ï¼šDocker, EC2 Auto Scalingï¼‰</td></tr><tr><td>ğŸ“ˆ å¯è¦–åŒ– / ãƒ¬ãƒãƒ¼ãƒˆ</td><td>âœ… ãƒ†ã‚¹ãƒˆãƒ­ã‚°ã€å‹•ç”»ã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨˜éŒ²ã‚ã‚Š</td><td>âŒ è‡ªåˆ†ã§ Allure ã‚„ Playwright Trace Viewer ã‚’çµ±åˆå¿…è¦</td></tr><tr><td>ğŸ§ª CI/CD é€£æº</td><td>âœ… GitHub Actions, Jenkins, GitLab ç­‰ã¨ç°¡å˜é€£æº</td><td>âœ… æŸ”è»Ÿã ãŒè¨­å®šã¯è‡ªåˆ†ã§è¡Œã†å¿…è¦ã‚ã‚Š</td></tr><tr><td>ğŸ’¸ ã‚³ã‚¹ãƒˆ</td><td>ğŸ’° åˆ©ç”¨æ™‚é–“ãƒ»ä¸¦åˆ—æ•°ã§èª²é‡‘ã€‚å°è¦æ¨¡ãƒãƒ¼ãƒ ã«ã¯ã‚„ã‚„é«˜é¡ã‹ã‚‚</td><td>ğŸ’° EC2ï¼ˆç‰¹ã«Spotï¼‰ãªã‚‰å®‰ä¾¡ã€‚ãŸã ã—ä¿å®ˆè² æ‹…ã‚ã‚Š</td></tr><tr><td>ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</td><td>âœ… ISO, SOC2ãªã©ã®ä¼æ¥­å‘ã‘èªè¨¼ã‚’å–å¾—</td><td>è¨­å®šæ¬¡ç¬¬ï¼ˆä¾‹ï¼šVPC, IAM, ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰</td></tr></tbody></table><hr><h2 id="ãŠã™ã™ã‚ã®é¸ã³æ–¹">ğŸ¯ ãŠã™ã™ã‚ã®é¸ã³æ–¹</h2><table><thead><tr><th>åˆ©ç”¨ã‚±ãƒ¼ã‚¹</th><th>æ¨å¥¨ç’°å¢ƒ</th></tr></thead><tbody><tr><td>ã™ãã«ä½¿ãˆã‚‹ç’°å¢ƒãŒæ¬²ã—ã„ã€ãƒ†ã‚¹ãƒˆãƒ­ã‚¸ãƒƒã‚¯ã«é›†ä¸­ã—ãŸã„</td><td>âœ… Sauce Labs</td></tr><tr><td>DevOps ãƒãƒ¼ãƒ ã‚ã‚Šã€ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆãŸã„å ´åˆ</td><td>âœ… AWS è‡ªå‰æ§‹ç¯‰</td></tr><tr><td>macOS / Safari / iOS ã®ãƒ†ã‚¹ãƒˆãŒå¿…è¦ãªå ´åˆ</td><td>âœ… Sauce Labsï¼ˆã¾ãŸã¯ AWS EC2 Macï¼‰</td></tr><tr><td>ãƒ†ã‚¹ãƒˆè¨˜éŒ²ã‚„å¯è¦–åŒ–ãƒ¬ãƒãƒ¼ãƒˆãŒæ¬²ã—ã„å ´åˆ</td><td>âœ… Sauce Labs</td></tr><tr><td>ãƒ†ã‚¹ãƒˆé »åº¦ãŒå°‘ãªã„ã€å°è¦æ¨¡æ¤œè¨¼ç”¨</td><td>AWS + ãƒ­ãƒ¼ã‚«ãƒ« or ã‚³ãƒ³ãƒ†ãƒŠæ§‹ç¯‰ã§ååˆ†</td></tr></tbody></table><hr><p>å¿…è¦ã§ã‚ã‚Œã°ã€ä»¥ä¸‹ã®è³‡æ–™ã‚‚ã”æä¾›å¯èƒ½ã§ã™ï¼š</p><ul><li>AWS ä¸Šã§ Playwright å®Ÿè¡Œç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹ Dockerfile + CI è¨­å®šä¾‹</li><li>Sauce Labs ä¸Šã§ Playwright ã‚’ä½¿ã† <code>.yml</code> è¨­å®šä¾‹</li><li>ã‚³ã‚¹ãƒˆæ¯”è¼ƒã®ç›®å®‰</li></ul><p>è©³ã—ãçŸ¥ã‚ŠãŸã„é …ç›®ãŒã‚ã‚Œã°ã€ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚</p><p>SauceLabsã§300ä¸¦åˆ—ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆåŒæ™‚å®Ÿè¡Œæ•°ï¼‰ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã€<strong>Enterpriseãƒ—ãƒ©ãƒ³</strong>ãŒå¿…è¦ã¨ãªã‚Šã¾ã™ã€‚</p><hr><h3 id="enterpriseãƒ—ãƒ©ãƒ³ã®æ¦‚è¦">ğŸ’° Enterpriseãƒ—ãƒ©ãƒ³ã®æ¦‚è¦</h3><p>Sauce Labsã®å…¬å¼ã‚µã‚¤ãƒˆã§ã¯ã€æ¨™æº–ãƒ—ãƒ©ãƒ³ï¼ˆLive Testingã€VirtualCloudã€Real DeviceCloudï¼‰ã¯æœ€å¤§24ä¸¦åˆ—ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¾ã§ã®å¯¾å¿œã¨ãªã£ã¦ãŠã‚Šã€ãã‚Œä»¥ä¸Šã®ä¸¦åˆ—æ•°ã‚’å¸Œæœ›ã™ã‚‹å ´åˆã¯Enterpriseãƒ—ãƒ©ãƒ³ã®å¥‘ç´„ãŒå¿…è¦ã§ã™ã€‚([saucelabs.com][1])</p><p>Enterpriseãƒ—ãƒ©ãƒ³ã®ä¸»ãªç‰¹å¾´ï¼š</p><ul><li><strong>300ä»¥ä¸Šã®ä¸¦åˆ—ã‚»ãƒƒã‚·ãƒ§ãƒ³</strong>ã«å¯¾å¿œ</li><li><strong>ç„¡åˆ¶é™ã®è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“</strong></li><li><strong>å°‚ç”¨ã®ã‚µãƒãƒ¼ãƒˆä½“åˆ¶</strong>ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚µãƒãƒ¼ãƒˆã€æŠ€è¡“ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ãªã©ï¼‰</li><li><strong>SSOï¼ˆã‚·ãƒ³ã‚°ãƒ«ã‚µã‚¤ãƒ³ã‚ªãƒ³ï¼‰å¯¾å¿œ</strong></li><li><strong>ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ‡ãƒã‚¤ã‚¹ã‚¯ãƒ©ã‚¦ãƒ‰ã®åˆ©ç”¨</strong></li><li><strong>ãƒãƒ¼ãƒ ç®¡ç†æ©Ÿèƒ½</strong></li><li><strong>ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</strong></li></ul><p>å…·ä½“çš„ãªæ–™é‡‘ã«ã¤ã„ã¦ã¯ã€å…¬å¼ã‚µã‚¤ãƒˆã«ã¯è¨˜è¼‰ãŒãªãã€<strong>ã‚«ã‚¹ã‚¿ãƒ è¦‹ç©ã‚‚ã‚Š</strong>ã¨ãªã‚Šã¾ã™ã€‚</p><hr><h3 id="è¦‹ç©ã‚‚ã‚Šã®å–å¾—æ–¹æ³•">ğŸ“ è¦‹ç©ã‚‚ã‚Šã®å–å¾—æ–¹æ³•</h3><p>300ä¸¦åˆ—ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®åˆ©ç”¨ã‚’æ¤œè¨ã•ã‚Œã¦ã„ã‚‹å ´åˆã€SauceLabsã®å–¶æ¥­ãƒãƒ¼ãƒ ã«ç›´æ¥ãŠå•ã„åˆã‚ã›ã„ãŸã ãã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚</p><ul><li><p><strong>ãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ </strong>ï¼š <a href="https://saucelabs.com/contact">https://saucelabs.com/contact</a>([BusinessInsider][2])</p></li><li><p><strong>ãƒ‡ãƒ¢ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</strong>ï¼š <a href="https://saucelabs.com/demo">https://saucelabs.com/demo</a>([G2][3])</p></li></ul><p>ã“ã‚Œã‚‰ã®ãƒšãƒ¼ã‚¸ã‹ã‚‰ã€å¿…è¦ãªä¸¦åˆ—æ•°ã‚„åˆ©ç”¨ç›®çš„ã€ãƒãƒ¼ãƒ è¦æ¨¡ãªã©ã®æƒ…å ±ã‚’æä¾›ã™ã‚‹ã“ã¨ã§ã€æœ€é©ãªãƒ—ãƒ©ãƒ³ã¨æ–™é‡‘ã®ææ¡ˆã‚’å—ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p><hr><h3 id="è£œè¶³æƒ…å ±">ğŸ“ è£œè¶³æƒ…å ±</h3><ul><li><p>G2ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«ã‚ˆã‚‹ã¨ã€SauceLabsã‚’åˆ©ç”¨ã—ã¦<strong>110ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’åŒæ™‚ã«èµ·å‹•</strong>ã—ã€300ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’10åˆ†ä»¥å†…ã«å®Ÿè¡Œã—ãŸäº‹ä¾‹ãŒã‚ã‚Šã¾ã™ã€‚([G2][3])</p></li><li><p>ã“ã®ã‚ˆã†ã«ã€SauceLabsã®Enterpriseãƒ—ãƒ©ãƒ³ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€å¤§è¦æ¨¡ãªä¸¦åˆ—ãƒ†ã‚¹ãƒˆã®å®Ÿè¡ŒãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚</p></li></ul><hr><h1 id="docker-compose-playwright">Docker Compose + Playwright</h1><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ <strong>Docker Compose + Playwright</strong> å®ç°<strong>300 å¹¶å‘è®¿é—®</strong> çš„åŸºæœ¬ç¤ºä¾‹æ–¹æ¡ˆã€‚è¿™ä¸ªæ–¹æ¡ˆåˆ©ç”¨å¤šä¸ª Dockerå®¹å™¨å¹¶è¡Œè¿è¡Œ Playwright è„šæœ¬ï¼Œæ¯ä¸ªå®¹å™¨æ‰§è¡Œä¸€éƒ¨åˆ†ä»»åŠ¡ï¼Œæ€»ä½“è¾¾åˆ° 300å¹¶å‘è®¿é—®çš„ç›®çš„ã€‚</p><hr><h2 id="ç›®æ ‡">âœ… ç›®æ ‡</h2><ul><li>æ¯ä¸ªå®¹å™¨æ‰§è¡Œ 10 å¹¶å‘ context</li><li>å¯åŠ¨ 30 ä¸ªå®¹å™¨ â†’ æ€»å…± 300 å¹¶å‘è¯·æ±‚</li></ul><hr><h2 id="é¡¹ç›®ç»“æ„">ğŸ“ é¡¹ç›®ç»“æ„</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus">playwright-loadtest/<br>â”œâ”€â”€ docker-compose<span class="hljs-selector-class">.yml</span><br>â”œâ”€â”€ Dockerfile<br>â”œâ”€â”€ package<span class="hljs-selector-class">.json</span><br>â”œâ”€â”€ loadtest.js<br></code></pre></td></tr></table></figure><hr><h2 id="dockerfile">ğŸ³ Dockerfile</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Dockerfile"><span class="hljs-keyword">FROM</span> mcr.microsoft.com/playwright:v1.<span class="hljs-number">43.1</span>-jammy<br><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> . .</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> npm install</span><br><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;node&quot;</span>, <span class="hljs-string">&quot;loadtest.js&quot;</span>]</span><br></code></pre></td></tr></table></figure><hr><h2 id="package.json">ğŸ“¦ package.json</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;playwright-loadtest&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;node loadtest.js&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;playwright&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^1.43.1&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><hr><h2 id="loadtest.js1å®¹å™¨æ‰§è¡Œ10å¹¶å‘">ğŸ§ªloadtest.jsï¼ˆ1å®¹å™¨æ‰§è¡Œ10å¹¶å‘ï¼‰</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; chromium &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;playwright&#x27;</span>);<br><br>(<span class="hljs-title function_">async</span> () =&gt; &#123;<br>  <span class="hljs-keyword">const</span> browser = <span class="hljs-keyword">await</span> chromium.<span class="hljs-title function_">launch</span>(&#123; <span class="hljs-attr">headless</span>: <span class="hljs-literal">true</span> &#125;);<br>  <span class="hljs-keyword">const</span> tasks = [];<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>    tasks.<span class="hljs-title function_">push</span>((<span class="hljs-title function_">async</span> () =&gt; &#123;<br>      <span class="hljs-keyword">const</span> context = <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">newContext</span>();<br>      <span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> context.<span class="hljs-title function_">newPage</span>();<br>      <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">goto</span>(<span class="hljs-string">&#x27;https://example.com&#x27;</span>);<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Done: <span class="hljs-subst">$&#123;i&#125;</span>`</span>);<br>      <span class="hljs-keyword">await</span> context.<span class="hljs-title function_">close</span>();<br>    &#125;)());<br>  &#125;<br><br>  <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(tasks);<br>  <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">close</span>();<br>&#125;)();<br></code></pre></td></tr></table></figure><hr><h2 id="docker-compose.yml30-å®¹å™¨å¯åŠ¨">ğŸ§¬ docker-compose.ymlï¼ˆ30å®¹å™¨å¯åŠ¨ï¼‰</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;3&#x27;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">playwright:</span><br>    <span class="hljs-attr">build:</span> <span class="hljs-string">.</span><br>    <span class="hljs-attr">deploy:</span><br>      <span class="hljs-attr">replicas:</span> <span class="hljs-number">30</span>  <span class="hljs-comment"># ğŸš€ å¯åŠ¨ 30 ä¸ªå®¹å™¨ x æ¯å®¹å™¨10å¹¶å‘ = 300å¹¶å‘</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">&quot;no&quot;</span><br></code></pre></td></tr></table></figure><blockquote><p>âš ï¸ æ³¨æ„ï¼šéœ€è¦ <code>docker compose up --scale playwright=30</code>æˆ–ä½¿ç”¨ <code>deploy.replicas</code>ï¼ˆéœ€è¦ swarm modeï¼‰</p></blockquote><hr><h2 id="å¯åŠ¨å‘½ä»¤">ğŸš€ å¯åŠ¨å‘½ä»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ„å»ºé•œåƒ</span><br>docker compose build<br><br><span class="hljs-comment"># å¯åŠ¨ 30 ä¸ªå®ä¾‹</span><br>docker compose up --scale playwright=30<br></code></pre></td></tr></table></figure><hr><h2 id="æ³¨æ„äº‹é¡¹">âœ… æ³¨æ„äº‹é¡¹</h2><table><thead><tr><th>æ³¨æ„ç‚¹</th><th>å†…å®¹</th></tr></thead><tbody><tr><td><strong>ç³»ç»Ÿèµ„æº</strong></td><td>æ¯ä¸ªå®¹å™¨éœ€è¦çº¦ 0.5ï½1GB å†…å­˜ï¼Œéœ€ç¡®ä¿è‡³å°‘ 16ï½32GB RAM</td></tr><tr><td><strong>ç›®æ ‡ç½‘ç«™é™åˆ¶</strong></td><td>ä¸è¦å¯¹ç”Ÿäº§ç¯å¢ƒå‘èµ·300å¹¶å‘æµ‹è¯•ï¼Œè¯·ä½¿ç”¨å…è®¸å‹æµ‹çš„URL</td></tr><tr><td><strong>Docker é™åˆ¶</strong></td><td>å¹¶å‘è¿‡é«˜å¯èƒ½è§¦å‘ Docker NAT or network å¸¦å®½é™åˆ¶</td></tr><tr><td><strong>æ‹¡å¼µæ€§</strong></td><td>å¯æ›¿æ¢ä¸º Kubernetes + HPA å®ç°æ›´é«˜çº§è°ƒåº¦</td></tr></tbody></table><hr><h2 id="æ‹“å±•å»ºè®®">ğŸ“¦ æ‹“å±•å»ºè®®</h2><ul><li>ä½¿ç”¨ç¯å¢ƒå˜é‡é…ç½®æ¯ä¸ªå®¹å™¨çš„ä»»åŠ¡æ•°</li><li>å°†è¯·æ±‚ç»“æœå†™å…¥ Redis/PostgreSQL ç­‰ç”¨äºåç»­åˆ†æ</li><li>é›†æˆ Grafana + Prometheus ç›‘æ§è¿è¡Œæƒ…å†µ</li></ul><hr><h1 id="docker-compose-playwright2">Docker Compose + Playwright2</h1><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ª<strong>åªç”¨ <code>docker-compose.yml</code> æ¥ç™»å½•Salesforce å¹¶æ‰§è¡Œ Playwright å¹¶å‘è®¿é—®ï¼ˆå« Cookieé‡ç”¨ï¼‰çš„å®Œæ•´å®ç°æ–¹æ¡ˆ</strong>ï¼Œä¸éœ€è¦ä½ æ‰‹åŠ¨æ‰§è¡Œ<code>docker build</code> æˆ– <code>docker run</code> å‘½ä»¤ã€‚</p><hr><h2 id="æ–¹æ¡ˆæ¦‚è¿°ä¸€æ¬¡æ€§æ‰§è¡Œ-login-å¹¶å‘è®¿é—®">âœ… æ–¹æ¡ˆæ¦‚è¿°ï¼ˆä¸€æ¬¡æ€§æ‰§è¡Œ login+ å¹¶å‘è®¿é—®ï¼‰</h2><p>æˆ‘ä»¬å°†æ„å»ºä¸¤ä¸ªæœåŠ¡ï¼š</p><ol type="1"><li><strong>login</strong>ï¼šæ‰§è¡Œ Salesforce ç™»å½•å¹¶ä¿å­˜ cookie</li><li><strong>parallel</strong>ï¼šè¯»å– cookie å¹¶å‘èµ· 10 å¹¶å‘è¯·æ±‚</li></ol><p>å¹¶é€šè¿‡ <code>depends_on</code> ç¡®ä¿ login åœ¨å¹¶å‘è®¿é—®ä¹‹å‰å®Œæˆã€‚</p><hr><h2 id="é¡¹ç›®ç»“æ„-1">ğŸ“ é¡¹ç›®ç»“æ„</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">salesforce-playwright/<br>â”œâ”€â”€ docker-compose<span class="hljs-selector-class">.yml</span><br>â”œâ”€â”€ Dockerfile<br>â”œâ”€â”€ login<span class="hljs-selector-class">.js</span><br>â”œâ”€â”€ parallelAccess<span class="hljs-selector-class">.js</span><br>â”œâ”€â”€ package.json<br></code></pre></td></tr></table></figure><hr><h2 id="docker-compose.ymlæ ¸å¿ƒ">ğŸ³ docker-compose.ymlï¼ˆæ ¸å¿ƒï¼‰</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;3.8&quot;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">login:</span><br>    <span class="hljs-attr">build:</span> <span class="hljs-string">.</span><br>    <span class="hljs-attr">command:</span> <span class="hljs-string">node</span> <span class="hljs-string">login.js</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">.:/app</span><br>    <span class="hljs-comment"># cookie å­˜å‚¨ç”¨</span><br>    <span class="hljs-attr">working_dir:</span> <span class="hljs-string">/app</span><br><br>  <span class="hljs-attr">parallel:</span><br>    <span class="hljs-attr">build:</span> <span class="hljs-string">.</span><br>    <span class="hljs-attr">command:</span> <span class="hljs-string">node</span> <span class="hljs-string">parallelAccess.js</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">.:/app</span><br>    <span class="hljs-attr">depends_on:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">login</span><br>    <span class="hljs-attr">working_dir:</span> <span class="hljs-string">/app</span><br></code></pre></td></tr></table></figure><hr><h2 id="dockerfileå…±é€š">ğŸ³ Dockerfileï¼ˆå…±é€šï¼‰</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Dockerfile"><span class="hljs-keyword">FROM</span> mcr.microsoft.com/playwright:v1.<span class="hljs-number">43.1</span>-jammy<br><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> . .</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> npm install</span><br></code></pre></td></tr></table></figure><hr><h2 id="login.jsé¦–æ¬¡ç™»å½•å¹¶ä¿å­˜-cookie">ğŸ§  login.jsï¼ˆé¦–æ¬¡ç™»å½•å¹¶ä¿å­˜cookieï¼‰</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; chromium &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;playwright&#x27;</span>);<br><br>(<span class="hljs-title function_">async</span> () =&gt; &#123;<br>  <span class="hljs-keyword">const</span> browser = <span class="hljs-keyword">await</span> chromium.<span class="hljs-title function_">launch</span>(&#123; <span class="hljs-attr">headless</span>: <span class="hljs-literal">true</span> &#125;);<br>  <span class="hljs-keyword">const</span> context = <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">newContext</span>();<br>  <span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> context.<span class="hljs-title function_">newPage</span>();<br><br>  <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">goto</span>(<span class="hljs-string">&#x27;https://login.salesforce.com&#x27;</span>);<br>  <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">fill</span>(<span class="hljs-string">&#x27;input#username&#x27;</span>, process.<span class="hljs-property">env</span>.<span class="hljs-property">SF_USERNAME</span> || <span class="hljs-string">&#x27;&#x27;</span>);<br>  <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">fill</span>(<span class="hljs-string">&#x27;input#password&#x27;</span>, process.<span class="hljs-property">env</span>.<span class="hljs-property">SF_PASSWORD</span> || <span class="hljs-string">&#x27;&#x27;</span>);<br>  <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<br>    page.<span class="hljs-title function_">waitForNavigation</span>(),<br>    page.<span class="hljs-title function_">click</span>(<span class="hljs-string">&#x27;input#Login&#x27;</span>),<br>  ]);<br><br>  <span class="hljs-keyword">await</span> context.<span class="hljs-title function_">storageState</span>(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;sf-auth.json&#x27;</span> &#125;);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;âœ… Logged in and saved auth&#x27;</span>);<br>  <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">close</span>();<br>&#125;)();<br></code></pre></td></tr></table></figure><hr><h2 id="parallelaccess.jså¹¶å‘è®¿é—®">âš¡ parallelAccess.jsï¼ˆå¹¶å‘è®¿é—®ï¼‰</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; chromium &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;playwright&#x27;</span>);<br><br>(<span class="hljs-title function_">async</span> () =&gt; &#123;<br>  <span class="hljs-keyword">const</span> browser = <span class="hljs-keyword">await</span> chromium.<span class="hljs-title function_">launch</span>(&#123; <span class="hljs-attr">headless</span>: <span class="hljs-literal">true</span> &#125;);<br>  <span class="hljs-keyword">const</span> tasks = [];<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>    tasks.<span class="hljs-title function_">push</span>((<span class="hljs-title function_">async</span> () =&gt; &#123;<br>      <span class="hljs-keyword">const</span> context = <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">newContext</span>(&#123; <span class="hljs-attr">storageState</span>: <span class="hljs-string">&#x27;sf-auth.json&#x27;</span> &#125;);<br>      <span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> context.<span class="hljs-title function_">newPage</span>();<br>      <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">goto</span>(<span class="hljs-string">&#x27;https://your-domain.my.site.com/target-page&#x27;</span>);<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`âœ… Accessed <span class="hljs-subst">$&#123;i + <span class="hljs-number">1</span>&#125;</span>: <span class="hljs-subst">$&#123;<span class="hljs-keyword">await</span> page.title()&#125;</span>`</span>);<br>      <span class="hljs-keyword">await</span> context.<span class="hljs-title function_">close</span>();<br>    &#125;)());<br>  &#125;<br><br>  <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(tasks);<br>  <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">close</span>();<br>&#125;)();<br></code></pre></td></tr></table></figure><hr><h2 id="package.jsonä¾èµ–å®šä¹‰">ğŸ“¦ package.jsonï¼ˆä¾èµ–å®šä¹‰ï¼‰</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;salesforce-playwright&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;playwright&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^1.43.1&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><hr><h2 id="ä¸€é”®æ‰§è¡Œå‘½ä»¤">ğŸš€ ä¸€é”®æ‰§è¡Œå‘½ä»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker compose up --build<br></code></pre></td></tr></table></figure><p>è¿™å°†é¡ºåºæ‰§è¡Œï¼š</p><ol type="1"><li>login æœåŠ¡ï¼ˆä¿å­˜ Cookieï¼‰</li><li>parallel æœåŠ¡ï¼ˆè¯»å– Cookie å¹¶å‘è®¿é—®ï¼‰</li></ol><hr><h2 id="ç¯å¢ƒå˜é‡å¯é€‰">ğŸ§ª ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰</h2><p>ä½ ä¹Ÿå¯ä»¥å°† <code>SF_USERNAME</code> å’Œ <code>SF_PASSWORD</code> å†™å…¥<code>.env</code> æ–‡ä»¶ï¼ŒCompose ä¼šè‡ªåŠ¨åŠ è½½ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">SF_USERNAME</span>=your-username@example.com<br><span class="hljs-attr">SF_PASSWORD</span>=your-password<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨ login.js ä¸­ä½¿ç”¨ <code>process.env.SF_USERNAME</code></p><hr><h2 id="æ•´ä½“ä¼˜åŠ¿">âœ… æ•´ä½“ä¼˜åŠ¿</h2><table><thead><tr><th>é¡¹ç›®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ç°¡å˜æ€§</td><td>åªéœ€ <code>docker compose up --build</code> ä¸€æ¡å‘½ä»¤</td></tr><tr><td>å†åˆ©ç”¨æ€§</td><td>Cookie ä¿å­˜åœ¨å®¹å™¨ volume ä¸­ï¼Œå¯é‡å¤ä½¿ç”¨</td></tr><tr><td>å¯æ‰©å±•æ€§</td><td>å¹¶å‘æ•°å¯è°ƒï¼Œé€‚åˆåŠ å¤§åˆ° 100 æˆ– 300</td></tr><tr><td>CI/CDå¯¾å¿œ</td><td>å¯åµŒå…¥ GitHub Actionsã€GitLab CI ç­‰</td></tr></tbody></table><hr><p>å¦‚æœä½ éœ€è¦è¿™ä¸ªå®Œæ•´é¡¹ç›®ä½œä¸º <code>.zip</code> æ–‡ä»¶æˆ–è€… GitHubæ¨¡æ¿ï¼Œæˆ‘å¯ä»¥ç«‹å³å¸®ä½ ç”Ÿæˆã€‚æ˜¯å¦éœ€è¦ï¼Ÿ</p><h1 id="play-wright">play wright</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs csharp">import &#123; test, expect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@playwright/test&#x27;</span>;<br><br>test(<span class="hljs-string">&#x27;set lightning-combobox value&#x27;</span>, <span class="hljs-keyword">async</span> (&#123; page &#125;) =&gt; &#123;<br>  <span class="hljs-keyword">await</span> page.<span class="hljs-keyword">goto</span>(<span class="hljs-string">&#x27;https://your-salesforce-instance.com&#x27;</span>);<br><br>  <span class="hljs-comment">// Open the shadow-root-based combobox</span><br>  <span class="hljs-keyword">const</span> comboInput = page.locator(<span class="hljs-string">&#x27;lightning-combobox &gt;&gt;&gt; [role=&quot;combobox&quot;]&#x27;</span>);<br>  <span class="hljs-keyword">await</span> comboInput.click();<br><br>  <span class="hljs-comment">// Select option (e.g., data-value=&quot;option1&quot;)</span><br>  <span class="hljs-keyword">const</span> option = page.locator(<span class="hljs-string">&#x27;lightning-combobox &gt;&gt;&gt; [role=&quot;option&quot;][data-value=&quot;option1&quot;]&#x27;</span>);<br>  <span class="hljs-keyword">await</span> option.click();<br><br>  <span class="hljs-comment">// Optional: verify selected text</span><br>  <span class="hljs-keyword">const</span> selectedText = <span class="hljs-keyword">await</span> comboInput.inputValue();<br>  expect(selectedText).toBe(<span class="hljs-string">&#x27;Option 1&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><h1 id="server-response">server response</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; chromium &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;playwright&#x27;</span>);<br><br>(<span class="hljs-title function_">async</span> () =&gt; &#123;<br>  <span class="hljs-keyword">const</span> browser = <span class="hljs-keyword">await</span> chromium.<span class="hljs-title function_">launch</span>();<br>  <span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">newPage</span>();<br><br>  <span class="hljs-keyword">let</span> startTime = <span class="hljs-number">0</span>;<br><br>  <span class="hljs-comment">// ç‰¹å®šã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã—ã¦</span><br>  page.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;request&#x27;</span>, <span class="hljs-function"><span class="hljs-params">request</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (request.<span class="hljs-title function_">url</span>().<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;/api/some-endpoint&#x27;</span>)) &#123;<br>      startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>    &#125;<br>  &#125;);<br><br>  page.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;response&#x27;</span>, <span class="hljs-keyword">async</span> response =&gt; &#123;<br>    <span class="hljs-keyword">if</span> (response.<span class="hljs-title function_">url</span>().<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;/api/some-endpoint&#x27;</span>)) &#123;<br>      <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - startTime;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`API å¿œç­”æ™‚é–“: <span class="hljs-subst">$&#123;duration&#125;</span> ms`</span>);<br>    &#125;<br>  &#125;);<br><br>  <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">goto</span>(<span class="hljs-string">&#x27;https://example.com&#x27;</span>);<br>  <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">click</span>(<span class="hljs-string">&#x27;button#call-api&#x27;</span>); <span class="hljs-comment">// API å‘¼ã³å‡ºã—ã‚’ãƒˆãƒªã‚¬ãƒ¼</span><br><br>  <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">waitForTimeout</span>(<span class="hljs-number">2000</span>); <span class="hljs-comment">// å¿œç­”ã‚’å¾…ã¤</span><br>  <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">close</span>();<br>&#125;)();<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>load-test</title>
    <link href="/2025/04/21/load-test/"/>
    <url>/2025/04/21/load-test/</url>
    
    <content type="html"><![CDATA[<h2 id="ç›®çš„">âœ… ç›®çš„</h2><ul><li><p>Sauce Labs ä¸Šã§ Playwright ãƒ†ã‚¹ãƒˆã‚’ <strong>300ä¸¦è¡Œå®Ÿè¡Œ</strong></p></li><li><p>å„ã‚¢ã‚¯ã‚»ã‚¹ã«å¯¾ã—ã¦ï¼š</p><ul><li><code>browser.newContext()</code> ã‚’ä½¿ã„ç‹¬ç«‹ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ</li><li><code>page.goto()</code> ã«ã‹ã‹ã‚‹æ™‚é–“ï¼ˆåå¿œæ™‚é–“ï¼‰ã‚’è¨ˆæ¸¬</li></ul></li><li><p>çµæœã‚’ãƒ­ã‚° or ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ï¼ˆCSVã‚„JSONï¼‰</p></li></ul><hr><h2 id="å‰ææ¡ä»¶">âœ… å‰ææ¡ä»¶</h2><ol type="1"><li><strong>Sauce Labs ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</strong></li><li>Playwright ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ</li><li>Node.js ç’°å¢ƒ</li></ol><hr><h2 id="sauce-labs-playwright-ã®åŸºæœ¬æ§‹æˆsetup">âœ… Sauce Labs +Playwright ã®åŸºæœ¬æ§‹æˆï¼ˆsetupï¼‰</h2><p>ã¾ãšã€<code>sauce.config.js</code> ã‚’ä½œæˆã—ã¦ã€Sauce Labs ã«Playwright ãƒ†ã‚¹ãƒˆã‚’æ¥ç¶šã—ã¾ã™ã€‚</p><h3 id="step-1-install-å¿…è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸">ğŸ”§ Step 1: Installå¿…è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install --save-dev @saucelabs/playwright-runner playwright<br></code></pre></td></tr></table></figure><h3 id="ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆä¾‹">ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆä¾‹</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">project/<br>â”œâ”€â”€ sauce<span class="hljs-selector-class">.config</span><span class="hljs-selector-class">.js</span><br>â”œâ”€â”€ tests/<br>â”‚   â””â”€â”€ load<span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.js</span><br>â”œâ”€â”€ results/<br>â”‚   â””â”€â”€ result.csv<br></code></pre></td></tr></table></figure><hr><h2 id="step-2-sauce.config.js-è¨­å®šä¾‹">âœ… Step 2: sauce.config.jsè¨­å®šä¾‹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">runner</span>: <span class="hljs-string">&#x27;playwright&#x27;</span>,<br>  <span class="hljs-attr">region</span>: <span class="hljs-string">&#x27;us-west-1&#x27;</span>, <span class="hljs-comment">// ã¾ãŸã¯ eu-central-1</span><br>  <span class="hljs-attr">sauce</span>: &#123;<br>    <span class="hljs-attr">username</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">SAUCE_USERNAME</span>,<br>    <span class="hljs-attr">accessKey</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">SAUCE_ACCESS_KEY</span>,<br>    <span class="hljs-attr">metadata</span>: &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Playwright Load Test&#x27;</span>,<br>      <span class="hljs-attr">build</span>: <span class="hljs-string">&#x27;300-context-test&#x27;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">playwright</span>: &#123;<br>    <span class="hljs-attr">version</span>: <span class="hljs-string">&#x27;1.43.1&#x27;</span><br>  &#125;,<br>  <span class="hljs-attr">suites</span>: [<br>    &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;300-concurrent-access&#x27;</span>,<br>      <span class="hljs-attr">src</span>: [<span class="hljs-string">&#x27;./tests/load.test.js&#x27;</span>],<br>      <span class="hljs-attr">platformName</span>: <span class="hljs-string">&#x27;Windows 11&#x27;</span>,<br>      <span class="hljs-attr">browserName</span>: <span class="hljs-string">&#x27;chrome&#x27;</span>,<br>      <span class="hljs-attr">browserVersion</span>: <span class="hljs-string">&#x27;latest&#x27;</span><br>    &#125;<br>  ]<br>&#125;;<br></code></pre></td></tr></table></figure><hr><h2 id="step-3-playwright-ãƒ†ã‚¹ãƒˆã§-300-ä¸¦è¡Œã‚¢ã‚¯ã‚»ã‚¹load.test.js">âœ… Step3: Playwright ãƒ†ã‚¹ãƒˆã§ 300ä¸¦è¡Œã‚¢ã‚¯ã‚»ã‚¹ï¼ˆ<code>load.test.js</code>ï¼‰</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<br><span class="hljs-keyword">const</span> &#123; test &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@playwright/test&#x27;</span>);<br><br><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;Run 300 parallel context accesses&#x27;</span>, <span class="hljs-title function_">async</span> (&#123; browser &#125;) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CONCURRENCY</span> = <span class="hljs-number">300</span>;<br>  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TARGET_URL</span> = <span class="hljs-string">&#x27;https://example.com&#x27;</span>; <span class="hljs-comment">// â† ãƒ†ã‚¹ãƒˆå¯¾è±¡URL</span><br>  <span class="hljs-keyword">const</span> results = [];<br><br>  <span class="hljs-comment">// context å˜ä½ã§åŒæ™‚å®Ÿè¡Œ</span><br>  <span class="hljs-keyword">const</span> tasks = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(&#123; <span class="hljs-attr">length</span>: <span class="hljs-variable constant_">CONCURRENCY</span> &#125;, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> (<span class="hljs-title function_">async</span> () =&gt; &#123;<br>    <span class="hljs-keyword">const</span> context = <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">newContext</span>();<br>    <span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> context.<span class="hljs-title function_">newPage</span>();<br><br>    <span class="hljs-keyword">const</span> start = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>    <span class="hljs-keyword">let</span> duration = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">let</span> error = <span class="hljs-literal">null</span>;<br><br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">goto</span>(<span class="hljs-variable constant_">TARGET_URL</span>, &#123; <span class="hljs-attr">timeout</span>: <span class="hljs-number">30000</span> &#125;);<br>      duration = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - start;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`User <span class="hljs-subst">$&#123;i + <span class="hljs-number">1</span>&#125;</span> finished in <span class="hljs-subst">$&#123;duration&#125;</span> ms`</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>      error = err.<span class="hljs-property">message</span>;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`User <span class="hljs-subst">$&#123;i + <span class="hljs-number">1</span>&#125;</span> failed: <span class="hljs-subst">$&#123;error&#125;</span>`</span>);<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>      results.<span class="hljs-title function_">push</span>(&#123; <span class="hljs-attr">id</span>: i + <span class="hljs-number">1</span>, duration, error &#125;);<br>      <span class="hljs-keyword">await</span> context.<span class="hljs-title function_">close</span>();<br>    &#125;<br>  &#125;)());<br><br>  <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(tasks);<br><br>  <span class="hljs-comment">// ä¿å­˜ CSV</span><br>  <span class="hljs-keyword">const</span> csv = [<br>    <span class="hljs-string">&#x27;id,duration_ms,error&#x27;</span>,<br>    ...results.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">$&#123;r.id&#125;</span>,<span class="hljs-subst">$&#123;r.duration ?? <span class="hljs-string">&#x27;&#x27;</span>&#125;</span>,&quot;<span class="hljs-subst">$&#123;r.error ?? <span class="hljs-string">&#x27;&#x27;</span>&#125;</span>&quot;`</span>)<br>  ].<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;\n&#x27;</span>);<br>  fs.<span class="hljs-title function_">writeFileSync</span>(<span class="hljs-string">&#x27;./results/result.csv&#x27;</span>, csv);<br>&#125;);<br></code></pre></td></tr></table></figure><hr><h2 id="step-4-ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ">âœ… Step 4: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</h2><p>ç’°å¢ƒå¤‰æ•°ã§ Sauce Labs ã®èªè¨¼æƒ…å ±ã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> SAUCE_USERNAME=your-username<br><span class="hljs-built_in">export</span> SAUCE_ACCESS_KEY=your-access-key<br><br>npx saucectl run<br></code></pre></td></tr></table></figure><p>â€» Windows ã®å ´åˆã¯ <code>set</code> ã‚³ãƒãƒ³ãƒ‰ã§ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š</p><hr><h2 id="è£œè¶³ä¸¦åˆ—æ•°ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã«ã¤ã„ã¦">âœ…è£œè¶³ï¼šä¸¦åˆ—æ•°ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã«ã¤ã„ã¦</h2><p>Sauce Labs ã® <strong>ä¸¦åˆ—ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°ï¼ˆconcurrency limitï¼‰</strong>ã«ä¾å­˜ã—ã¾ã™ã€‚</p><ul><li>ç„¡æ–™ãƒ—ãƒ©ãƒ³ãƒ»Basicï¼š1ã€œ2 ä¸¦åˆ—</li><li>ãƒãƒ¼ãƒ ï¼Enterpriseï¼š20ã€œ200 ä¸¦åˆ—å¯èƒ½ï¼ˆå¥‘ç´„æ¬¡ç¬¬ï¼‰</li></ul><p>ğŸ¯ <strong>300ä¸¦è¡Œã‚¢ã‚¯ã‚»ã‚¹ã‚’æœ¬ç•ªç’°å¢ƒã§ä¸€åº¦ã«èµ°ã‚‰ã›ãŸã„å ´åˆã€Enterpriseå¥‘ç´„ã‚„ä¸¦åˆ—æ•°åˆ¶å¾¡ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆä¾‹ï¼šbatch å®Ÿè¡Œï¼‰ãŒå¿…è¦ã§ã™ã€‚</strong></p><hr><h2 id="ãƒãƒƒãƒçš„ã«300ä¸¦è¡Œã‚’å†ç¾ä»£æ›¿æ¡ˆ">âœ…ãƒãƒƒãƒçš„ã«300ä¸¦è¡Œã‚’å†ç¾ï¼ˆä»£æ›¿æ¡ˆï¼‰</h2><p>300ã‚’ä¸€æ°—ã«å®Ÿè¡Œã§ããªã„å ´åˆï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">BATCH_SIZE</span> = <span class="hljs-number">50</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">BATCH_COUNT</span> = <span class="hljs-number">6</span>;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable constant_">BATCH_COUNT</span>; i++) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Starting batch <span class="hljs-subst">$&#123;i + <span class="hljs-number">1</span>&#125;</span>`</span>);<br>  <span class="hljs-keyword">const</span> tasks = [];<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-variable constant_">BATCH_SIZE</span>; j++) &#123;<br>    tasks.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">runContextAccess</span>(i * <span class="hljs-variable constant_">BATCH_SIZE</span> + j + <span class="hljs-number">1</span>));<br>  &#125;<br>  <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(tasks);<br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="çµæœåˆ†æ">âœ… çµæœåˆ†æ</h2><ul><li>CSV å‡ºåŠ›çµæœã‚’ Excel ã‚„ pandas ã§åˆ†æ</li><li>ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‚„å¹³å‡ãƒ»ä¸­å¤®å€¤ã‚’å‡ºã›ã°ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ã®åã‚Šã‚’å¯è¦–åŒ–ã§ãã¾ã™</li></ul><hr><h2 id="ã¾ã¨ã‚">âœ… ã¾ã¨ã‚</h2><table><thead><tr><th>é …ç›®</th><th>å®Ÿç¾æ–¹æ³•</th></tr></thead><tbody><tr><td>300 ä¸¦è¡Œ</td><td><code>Promise.all</code> + <code>browser.newContext()</code></td></tr><tr><td>ã‚¯ãƒ©ã‚¦ãƒ‰å®Ÿè¡Œ</td><td>Sauce Labs ã® <code>saucectl</code> ã§å®Ÿè¡Œ</td></tr><tr><td>å¿œç­”æ™‚é–“è¨ˆæ¸¬</td><td><code>Date.now()</code> ã§ <code>page.goto()</code>ã®å‰å¾Œã‚’è¨˜éŒ²</td></tr><tr><td>çµæœä¿å­˜</td><td>CSVå½¢å¼ã§ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ› or ãƒ­ã‚°è¡¨ç¤º</td></tr><tr><td>ä¸¦åˆ—åˆ¶é™å¯¾ç­–</td><td>åˆ†å‰²å®Ÿè¡Œï¼ˆ50ä¸¦åˆ— Ã— 6ãƒãƒƒãƒï¼‰ã¾ãŸã¯ãƒ—ãƒ©ãƒ³ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰</td></tr></tbody></table><p>ç”»é¢åå¿œæ™‚é–“ã«é–¢ã‚ã‚‹ä¸»ãªè¦ç´ ï¼ˆ5ã‚«ãƒ†ã‚´ãƒªï¼‰</p><ol type="1"><li>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆDNS, SSL, TTFBï¼‰</li><li>ã‚µãƒ¼ãƒãƒ¼å‡¦ç†ï¼ˆApex, SOQL, APIé€£æºï¼‰</li><li>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°, JSå®Ÿè¡Œ, ãƒªã‚½ãƒ¼ã‚¹èª­ã¿è¾¼ã¿ï¼‰</li><li>UIæ§‹æˆï¼ˆLWCã®æç”»æ•°ãƒ»ãƒ­ã‚¸ãƒƒã‚¯ï¼‰</li><li>å¤–éƒ¨æ¡ä»¶ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥, ã‚»ãƒƒã‚·ãƒ§ãƒ³, ãƒ¦ãƒ¼ã‚¶ãƒ¼çŠ¶æ…‹ï¼‰</li></ol><p>ä»¥ä¸‹ã«ã€Salesforceï¼ˆç‰¹ã«ExperienceCloudã‚„LWCã‚’å¤šç”¨ã—ãŸãƒãƒ¼ã‚¿ãƒ«ï¼‰ã®å®Ÿç’°å¢ƒã«ãŠã„ã¦ã€Œ<strong>ç”»é¢åå¿œæ™‚é–“ã«å½±éŸ¿ã™ã‚‹ä¸Šä½5è¦ç´ </strong>ã€ã‚’<strong>å½±éŸ¿åº¦ãŒé«˜ã„é †ã«</strong>ãƒ©ãƒ³ã‚­ãƒ³ã‚°å½¢å¼ã§è§£èª¬ã—ã¾ã™ã€‚</p><hr><h2 id="ç”»é¢åå¿œæ™‚é–“ã«å½±éŸ¿ã™ã‚‹ä¸Šä½5è¦ç´ ">ğŸ†ç”»é¢åå¿œæ™‚é–“ã«å½±éŸ¿ã™ã‚‹ä¸Šä½5è¦ç´ </h2><h3 id="ä½apexå‡¦ç†ã‚µãƒ¼ãƒãƒ¼å‡¦ç†">ğŸ¥‡1ä½ï¼š<strong>Apexå‡¦ç†ï¼ˆã‚µãƒ¼ãƒãƒ¼å‡¦ç†ï¼‰</strong></h3><ul><li>è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã‚„å¤§è¦æ¨¡ãªSOQLã€å¤–éƒ¨APIé€£æºãŒã‚ã‚‹å ´åˆã€<strong>æœ€ã‚‚æ™‚é–“ãŒã‹ã‹ã‚‹å‚¾å‘</strong>ãŒã‚ã‚Šã¾ã™ã€‚</li><li>ç‰¹ã« <code>@wire</code>ã«ã‚ˆã‚‹å‘¼ã³å‡ºã—ãŒå¤šã„ç”»é¢ã§ã¯ã€ã‚µãƒ¼ãƒãƒ¼å‡¦ç†ãŒçµ‚ã‚ã‚‹ã¾ã§UIãŒæç”»ã•ã‚Œã¾ã›ã‚“ã€‚</li><li><strong>é…ã„ä¾‹</strong>ï¼šå¤šéšå±¤ã®é›†è¨ˆSOQLã€ãƒ«ãƒ¼ãƒ—å†…SOQLã€å¤–éƒ¨APIå‘¼ã³å‡ºã—ä»˜ãã®Apex</li></ul><hr><h3 id="ä½ãƒªã‚½ãƒ¼ã‚¹èª­ã¿è¾¼ã¿ç”»åƒcssjs">ğŸ¥ˆ2ä½ï¼š<strong>ãƒªã‚½ãƒ¼ã‚¹èª­ã¿è¾¼ã¿ï¼ˆç”»åƒãƒ»CSSãƒ»JSï¼‰</strong></h3><ul><li>Salesforceãƒãƒ¼ã‚¿ãƒ«ã¯ãƒ†ãƒ¼ãƒã‚„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«å¤šãã®é™çš„ãƒªã‚½ãƒ¼ã‚¹ãŒå«ã¾ã‚Œã¾ã™ã€‚</li><li>ç‰¹ã«ç”»åƒã‚µã‚¤ã‚ºãŒå¤§ãã„ï¼åœ§ç¸®ã•ã‚Œã¦ã„ãªã„ï¼CDNã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå¤–ã‚Œã‚‹ã¨<strong>LCPï¼ˆLargestContentful Paintï¼‰ã«æ‚ªå½±éŸ¿</strong>ã‚’ä¸ãˆã¾ã™ã€‚</li><li><strong>é…ã„ä¾‹</strong>ï¼šãƒ’ãƒ¼ãƒ­ãƒ¼ãƒãƒŠãƒ¼ã€ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã€å‹•çš„èª­ã¿è¾¼ã¿ã®ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒç¾¤</li></ul><hr><h3 id="ä½javascriptå®Ÿè¡Œã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå‡¦ç†">ğŸ¥‰3ä½ï¼š<strong>JavaScriptå®Ÿè¡Œï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå‡¦ç†ï¼‰</strong></h3><ul><li>LWCã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã®JSåˆæœŸåŒ–ãŒå¤šãã€<strong>DOMæç”»å‰ã«JSã®ä¾å­˜é–¢ä¿‚ãŒå‡¦ç†ã•ã‚Œã‚‹</strong></li><li>ç‰¹ã«å‹•çš„ãªæç”»ï¼ˆæ¡ä»¶ä»˜ãã€for:eachãªã©ï¼‰ã‚„ã€Apexå¿œç­”ã«å¿œã˜ã¦UIã‚’æ§‹ç¯‰ã™ã‚‹ã‚¿ã‚¤ãƒ—ã®ã‚³ãƒ¼ãƒ‰ã§ã¯å½±éŸ¿ãŒå¤§ãã„</li><li><strong>é…ã„ä¾‹</strong>ï¼šå¤šæ®µéšæ¡ä»¶åˆ†å²ã€è¤‡é›‘ãª JSONãƒ‘ãƒ¼ã‚¹ã¨æç”»</li></ul><hr><h3 id="ä½soqlã‚¯ã‚¨ãƒªã®æ€§èƒ½ã‚µãƒ¼ãƒãƒ¼å‡¦ç†ã®ä¸€éƒ¨">ğŸ…4ä½ï¼š<strong>SOQLã‚¯ã‚¨ãƒªã®æ€§èƒ½ï¼ˆã‚µãƒ¼ãƒãƒ¼å‡¦ç†ã®ä¸€éƒ¨ï¼‰</strong></h3><ul><li>Apexã®ä¸­ã§ã‚‚ç‰¹ã«SOQLã‚¯ã‚¨ãƒªãŒãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã«ãªã‚Šã‚„ã™ã„ã€‚</li><li>çµæœä»¶æ•°ãŒå¤šã„ã€éé¸æŠãƒªã‚¹ãƒˆé …ç›®ã«å¯¾ã™ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãªã—ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ¤œç´¢ãªã©ã¯<strong>æ˜ç¢ºã«é…ããªã‚‹</strong></li><li><strong>é…ã„ä¾‹</strong>ï¼šè¤‡æ•°ã®é–¢é€£ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’JOINã™ã‚‹ã‚ˆã†ãªã‚¯ã‚¨ãƒª</li></ul><hr><h3 id="ä½lwcã®æç”»æ•°ãƒ­ã‚¸ãƒƒã‚¯uiæ§‹æˆ">ğŸ–5ä½ï¼š<strong>LWCã®æç”»æ•°ãƒ»ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆUIæ§‹æˆï¼‰</strong></h3><ul><li>è¡¨ç¤ºæ™‚ã«æç”»ã•ã‚Œã‚‹LWCæ•°ãŒå¤šã„ã¨ã€ãã‚Œãã‚Œã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯(<code>connectedCallback</code>, <code>renderedCallback</code>)ãŒèµ°ã‚‹</li><li>ç‰¹ã«è¤‡é›‘ãªæ¡ä»¶è¡¨ç¤ºã‚„ for:eachã§å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹ç”»é¢ã¯æç”»é…å»¶ã«ç›´çµã™ã‚‹</li><li><strong>é…ã„ä¾‹</strong>ï¼š100ä»¶ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ãƒªã‚¹ãƒˆè¡¨ç¤ºã—ã€ã•ã‚‰ã«å„ãƒ¬ã‚³ãƒ¼ãƒ‰ã«ãƒœã‚¿ãƒ³/ã‚µãƒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æŒã¤å ´åˆ</li></ul><hr><h2 id="æƒ³å®šå¤–ã ã£ãŸã‘ã©ã‚ã¾ã‚Šé‡ããªã„è¦ç´ ">â›³æƒ³å®šå¤–ã ã£ãŸã‘ã©ã‚ã¾ã‚Šé‡ããªã„è¦ç´ </h2><table><thead><tr><th>è¦ç´ </th><th>å‚™è€ƒ</th></tr></thead><tbody><tr><td>DNS / SSL</td><td>ä¸€åº¦ç¢ºç«‹ã™ã‚Œã°åŸºæœ¬çš„ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œã‚‹ã€‚åˆå›ã‚¢ã‚¯ã‚»ã‚¹ã‚’é™¤ãç„¡è¦–ã§ãã‚‹ç¨‹åº¦</td></tr><tr><td>ã‚­ãƒ£ãƒƒã‚·ãƒ¥</td><td>CDNãŒæœ‰åŠ¹ã§ã‚ã‚Œã°ã‚€ã—ã‚æç”»ã‚’é«˜é€ŸåŒ–ã™ã‚‹</td></tr><tr><td>ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¢ºç«‹</td><td>é€šå¸¸ã¯SalesforceãŒé«˜é€Ÿã«å‡¦ç†ã—ã¦ãã‚Œã‚‹ã€‚ãŸã ã—å¤§é‡åŒæ™‚ãƒ­ã‚°ã‚¤ãƒ³ã¯æ³¨æ„</td></tr><tr><td>TTFB</td><td>Apexã‚„SOQLãŒé€Ÿã‘ã‚Œã°è‡ªå‹•çš„ã«çŸ­ããªã‚‹å‚¾å‘ãŒã‚ã‚‹ãŸã‚ã€é–“æ¥çš„ãªæŒ‡æ¨™</td></tr></tbody></table><hr><h2 id="ã¾ã¨ã‚ä¸Šä½5ãƒ©ãƒ³ã‚­ãƒ³ã‚°">âœ… ã¾ã¨ã‚ï¼šä¸Šä½5ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h2><table><thead><tr><th>é †ä½</th><th>è¦ç´ </th><th>ã‚«ãƒ†ã‚´ãƒª</th></tr></thead><tbody><tr><td>ğŸ¥‡1ä½</td><td>Apexå‡¦ç†ã®é…å»¶</td><td>ã‚µãƒ¼ãƒãƒ¼å‡¦ç†</td></tr><tr><td>ğŸ¥ˆ2ä½</td><td>ãƒªã‚½ãƒ¼ã‚¹ï¼ˆç”»åƒãƒ»CSSï¼‰ã®èª­è¾¼é…å»¶</td><td>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰</td></tr><tr><td>ğŸ¥‰3ä½</td><td>JSå®Ÿè¡Œè² è·</td><td>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰</td></tr><tr><td>ğŸ…4ä½</td><td>SOQLã‚¯ã‚¨ãƒªã®æœ€é©åŒ–ä¸è¶³</td><td>ã‚µãƒ¼ãƒãƒ¼å‡¦ç†</td></tr><tr><td>ğŸ–5ä½</td><td>LWCã®æç”»æ•°ã‚„æ¡ä»¶ãƒ­ã‚¸ãƒƒã‚¯</td><td>UIæ§‹æˆ</td></tr></tbody></table>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BlockChainåŸºç¡€ä¸€</title>
    <link href="/2025/02/09/BlockChain-Basic1/"/>
    <url>/2025/02/09/BlockChain-Basic1/</url>
    
    <content type="html"><![CDATA[<h1>ç­¾å</h1><h2 id="ç­¾åçš„æµç¨‹">ç­¾åçš„æµç¨‹</h2><pre><code class=" mermaid">sequenceDiagram    participant User as ç”¨æˆ·    participant Wallet as Web3é’±åŒ…    participant HashFunc as Keccak-256 å“ˆå¸Œ    participant ECDSA as ECDSA ç­¾å    participant Blockchain as åŒºå—é“¾(å¯é€‰)    Note right of User: 1. å‘èµ·äº¤æ˜“æˆ–æ¶ˆæ¯    User-&gt;&gt;Wallet: äº¤æ˜“/æ¶ˆæ¯æ•°æ®    Wallet-&gt;&gt;HashFunc: è®¡ç®— Keccak-256 å“ˆå¸Œ    HashFunc--&gt;&gt;Wallet: messageHash    Note right of Wallet: 2. ä½¿ç”¨ç§é’¥è¿›è¡Œ ECDSA ç­¾å    Wallet-&gt;&gt;ECDSA: ä½¿ç”¨ç§é’¥ç­¾å messageHash    ECDSA--&gt;&gt;Wallet: ç”Ÿæˆç­¾å (r, s, v)    Note right of Wallet: 3. è¿”å›ç­¾åæ•°æ®    Wallet--&gt;&gt;User: (r, s, v)    alt äº¤æ˜“ç­¾å        User-&gt;&gt;Blockchain: å¹¿æ’­å·²ç­¾åäº¤æ˜“        Blockchain--&gt;&gt;User: äº¤æ˜“ç¡®è®¤    else æ¶ˆæ¯ç­¾å        User-&gt;&gt;DApp: å‘é€ç­¾å        DApp-&gt;&gt;Wallet: ä½¿ç”¨å…¬é’¥éªŒè¯ç­¾å        Wallet--&gt;&gt;DApp: éªŒè¯æˆåŠŸ    end    Note right of User: ğŸ‰ ç­¾åå®Œæˆï¼</code></pre><h3 id="ç§é’¥ç­¾åçš„å…·ä½“è¿‡ç¨‹"><strong>ç§é’¥ç­¾åçš„å…·ä½“è¿‡ç¨‹</strong></h3><p>ç§é’¥ç­¾åçš„æ ¸å¿ƒåœ¨äºä½¿ç”¨ <strong>æ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•ï¼ˆECDSAï¼‰</strong> ç”Ÿæˆå”¯ä¸€çš„æ•°å­—ç­¾åï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œèº«ä»½è®¤è¯ã€‚åœ¨ä»¥å¤ªåŠå’Œ Web3 ç”Ÿæ€ä¸­ï¼Œç­¾åä¸»è¦ç”¨äºï¼š</p><ul><li><strong>äº¤æ˜“ç­¾åï¼ˆTransaction Signingï¼‰</strong></li><li><strong>æ¶ˆæ¯ç­¾åï¼ˆMessage Signingï¼‰</strong></li></ul><p>ä»¥ä¸‹æ˜¯ <strong>ç§é’¥ç­¾åçš„å®Œæ•´æŠ€æœ¯ç»†èŠ‚</strong>ï¼ŒåŒ…æ‹¬æ•°å­¦åŸç†å’Œä»£ç ç¤ºä¾‹ã€‚</p><hr><h2 id="1-ç§é’¥ç­¾åçš„æ•°å­¦åŸç†"><strong>1. ç§é’¥ç­¾åçš„æ•°å­¦åŸç†</strong></h2><p>åœ¨ä»¥å¤ªåŠä¸­ï¼Œç§é’¥ç­¾åä½¿ç”¨ <strong>æ¤­åœ†æ›²çº¿ SECP256k1</strong> å’Œ <strong>Keccak-256 å“ˆå¸Œç®—æ³•</strong>ã€‚å®Œæ•´æµç¨‹å¦‚ä¸‹ï¼š</p><h3 id="ğŸ”¹-1-1-ç”Ÿæˆå“ˆå¸Œå€¼"><strong>ğŸ”¹ 1.1 ç”Ÿæˆå“ˆå¸Œå€¼</strong></h3><ul><li>äº¤æ˜“æˆ–æ¶ˆæ¯æ•°æ®ä¼šå…ˆè¿›è¡Œ <strong>Keccak-256 å“ˆå¸Œè®¡ç®—</strong>ï¼Œå¾—åˆ° <code>messageHash</code>ã€‚</li></ul><h3 id="ğŸ”¹-1-2-ç”Ÿæˆç­¾å"><strong>ğŸ”¹ 1.2 ç”Ÿæˆç­¾å</strong></h3><p>ä½¿ç”¨ <strong>ç§é’¥ ( k )</strong> è¿›è¡Œ ECDSA ç­¾åï¼Œè®¡ç®—å‡º <code>(r, s, v)</code>ï¼š</p><ol><li><strong>éšæœºé€‰æ‹©ä¸€ä¸ªæ•° ( k_e )</strong>ï¼ˆå¿…é¡»æ˜¯å®‰å…¨çš„éšæœºæ•°ï¼‰ã€‚</li><li><strong>è®¡ç®—æ›²çº¿ç‚¹ ( P = k_e \cdot G )</strong><ul><li>å…¶ä¸­ <code>G</code> æ˜¯æ¤­åœ†æ›²çº¿çš„åŸºç‚¹ã€‚</li><li><code>r</code> æ˜¯ <code>P</code> ç‚¹çš„ <code>x</code> åæ ‡ã€‚</li></ul></li><li><strong>è®¡ç®—ç­¾åå‚æ•° ( s )</strong><ul><li>( s = k_e^{-1} \cdot (messageHash + r \cdot k) \mod n )</li><li>å…¶ä¸­ ( n ) æ˜¯æ›²çº¿çš„é˜¶ï¼Œ( k ) æ˜¯ç§é’¥ã€‚</li></ul></li><li><strong>è®¡ç®—æ¢å¤å‚æ•° ( v )</strong><ul><li>( v ) æ˜¯ä¸€ä¸ªé¢å¤–çš„å‚æ•°ï¼Œç”¨äºä»ç­¾åæ¢å¤å…¬é’¥ï¼ˆå–å€¼ <code>0</code> æˆ– <code>1</code>ï¼‰ã€‚</li></ul></li></ol><p>æœ€ç»ˆï¼Œç­¾åç”± <strong>(r, s, v)</strong> ä¸‰ä¸ªå€¼ç»„æˆã€‚</p><h3 id="ğŸ”¹-1-3-éªŒè¯ç­¾å"><strong>ğŸ”¹ 1.3 éªŒè¯ç­¾å</strong></h3><ol><li>ä½¿ç”¨å…¬é’¥å’Œ <code>r, s, v</code> è®¡ç®—æ¢å¤å‡ºçš„ <code>messageHash</code>ã€‚</li><li>è‹¥æ¢å¤å‡ºçš„å“ˆå¸Œå€¼ä¸åŸå§‹ <code>messageHash</code> ç›¸åŒï¼Œåˆ™ç­¾åéªŒè¯é€šè¿‡ã€‚</li></ol><hr><h2 id="2-ç§é’¥ç­¾åçš„ä»£ç ç¤ºä¾‹"><strong>2. ç§é’¥ç­¾åçš„ä»£ç ç¤ºä¾‹</strong></h2><p>ä»¥ <strong>ä»¥å¤ªåŠ Web3.js</strong> ä¸ºä¾‹ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><h3 id="2-1-äº¤æ˜“ç­¾å"><strong>2.1 äº¤æ˜“ç­¾å</strong></h3><p>ä½¿ç”¨ <code>ethers.js</code> è¿›è¡Œ <strong>äº¤æ˜“ç­¾å</strong>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> &#123; ethers &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;ethers&quot;</span>);<br><br><span class="hljs-comment">// 1. ç”Ÿæˆç§é’¥ï¼ˆæˆ–ä½¿ç”¨å·²æœ‰ç§é’¥ï¼‰</span><br><span class="hljs-keyword">const</span> privateKey = <span class="hljs-string">&quot;0xYOUR_PRIVATE_KEY&quot;</span>;<br><span class="hljs-keyword">const</span> wallet = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Wallet</span>(privateKey);<br><br><span class="hljs-comment">// 2. æ„é€ äº¤æ˜“</span><br><span class="hljs-keyword">const</span> tx = &#123;<br>  <span class="hljs-attr">to</span>: <span class="hljs-string">&quot;0xRecipientAddress&quot;</span>,<br>  <span class="hljs-attr">value</span>: ethers.<span class="hljs-property">utils</span>.<span class="hljs-title function_">parseEther</span>(<span class="hljs-string">&quot;0.1&quot;</span>), <span class="hljs-comment">// å‘é€ 0.1 ETH</span><br>  <span class="hljs-attr">gasLimit</span>: <span class="hljs-number">21000</span>,<br>  <span class="hljs-attr">gasPrice</span>: ethers.<span class="hljs-property">utils</span>.<span class="hljs-title function_">parseUnits</span>(<span class="hljs-string">&quot;20&quot;</span>, <span class="hljs-string">&quot;gwei&quot;</span>),<br>  <span class="hljs-attr">nonce</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// äº¤æ˜“è®¡æ•°</span><br>  <span class="hljs-attr">chainId</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// ä»¥å¤ªåŠä¸»ç½‘</span><br>&#125;;<br><br><span class="hljs-comment">// 3. ç­¾åäº¤æ˜“</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">signTransaction</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> signedTx = <span class="hljs-keyword">await</span> wallet.<span class="hljs-title function_">signTransaction</span>(tx);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ç­¾ååçš„äº¤æ˜“: &quot;</span>, signedTx);<br>&#125;<br><br><span class="hljs-title function_">signTransaction</span>();<br></code></pre></td></tr></table></figure><p>ğŸ”¹ <strong>æµç¨‹è§£æ</strong></p><ul><li><code>wallet.signTransaction(tx)</code>ï¼šä½¿ç”¨ <strong>ç§é’¥å¯¹äº¤æ˜“è¿›è¡Œ ECDSA ç­¾å</strong>ï¼Œè¿”å› <code>(r, s, v)</code>ã€‚</li><li><code>signedTx</code>ï¼šè¿”å› <strong>å·²ç­¾åçš„äº¤æ˜“æ•°æ®</strong>ï¼Œå¯ä»¥ç›´æ¥å¹¿æ’­åˆ°åŒºå—é“¾ç½‘ç»œã€‚</li></ul><hr><h3 id="2-2-æ¶ˆæ¯ç­¾å"><strong>2.2 æ¶ˆæ¯ç­¾å</strong></h3><p>ä½¿ç”¨ <code>ethers.js</code> è¿›è¡Œ <strong>æ¶ˆæ¯ç­¾å</strong>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> message = <span class="hljs-string">&quot;Hello, Web3!&quot;</span>;<br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">signMessage</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> signature = <span class="hljs-keyword">await</span> wallet.<span class="hljs-title function_">signMessage</span>(message);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ç­¾å:&quot;</span>, signature);<br>&#125;<br><span class="hljs-title function_">signMessage</span>();<br></code></pre></td></tr></table></figure><p>ğŸ”¹ <strong>æµç¨‹è§£æ</strong></p><ul><li><code>wallet.signMessage(message)</code> è®¡ç®— <code>Keccak-256</code> å“ˆå¸Œï¼Œç„¶åç”¨ç§é’¥è¿›è¡Œ ECDSA ç­¾åï¼Œè¿”å› <code>(r, s, v)</code>ã€‚</li><li>ä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨å…¬é’¥ <strong>éªŒè¯ç­¾åçš„åˆæ³•æ€§</strong>ã€‚</li></ul><hr><h3 id="2-3-EIP-712-ç»“æ„åŒ–ç­¾å"><strong>2.3 EIP-712 ç»“æ„åŒ–ç­¾å</strong></h3><p>EIP-712 è®©ç­¾å <strong>æ›´å®‰å…¨</strong>ï¼Œç”¨äº <strong>DApp æˆæƒï¼ˆå¦‚ OpenSea NFT ç­¾åï¼‰</strong>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> domain = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;MyDApp&quot;</span>,<br>  <span class="hljs-attr">version</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>  <span class="hljs-attr">chainId</span>: <span class="hljs-number">1</span>,<br>&#125;;<br><br><span class="hljs-keyword">const</span> message = &#123;<br>  <span class="hljs-attr">action</span>: <span class="hljs-string">&quot;Login&quot;</span>,<br>  <span class="hljs-attr">user</span>: <span class="hljs-string">&quot;0xYourAddress&quot;</span>,<br>&#125;;<br><br><span class="hljs-keyword">const</span> types = &#123;<br>  <span class="hljs-title class_">Login</span>: [<br>    &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;action&quot;</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;string&quot;</span> &#125;,<br>    &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;user&quot;</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;address&quot;</span> &#125;,<br>  ],<br>&#125;;<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">signTypedData</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> signature = <span class="hljs-keyword">await</span> wallet.<span class="hljs-title function_">_signTypedData</span>(domain, types, message);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;EIP-712 ç­¾å:&quot;</span>, signature);<br>&#125;<br><br><span class="hljs-title function_">signTypedData</span>();<br></code></pre></td></tr></table></figure><p>ğŸ”¹ <strong>æµç¨‹è§£æ</strong></p><ul><li><code>EIP-712</code> ç»“æ„åŒ–æ•°æ®ç­¾å <strong>é¿å…äº†ç­¾åæ¬ºéª—æ”»å‡»</strong>ï¼ˆå¦‚ä¼ªé€ äº¤æ˜“æˆæƒï¼‰ã€‚</li><li><code>wallet._signTypedData(domain, types, message)</code> ç”Ÿæˆ <code>(r, s, v)</code> å¹¶è¿”å›ç­¾åã€‚</li></ul><hr><h2 id="3-ç­¾åçš„å®‰å…¨æ€§"><strong>3. ç­¾åçš„å®‰å…¨æ€§</strong></h2><h3 id="ğŸ”¹-3-1-ç­¾åæ˜¯å¦æš´éœ²ç§é’¥ï¼Ÿ"><strong>ğŸ”¹ 3.1 ç­¾åæ˜¯å¦æš´éœ²ç§é’¥ï¼Ÿ</strong></h3><p>ä¸ä¼šï¼ç­¾å <code>(r, s, v)</code> åªæ˜¯è¯æ˜ <strong>ç§é’¥æŒæœ‰è€…ç¡®è®¤äº†äº¤æ˜“æˆ–æ¶ˆæ¯</strong>ï¼Œä½†ä¸ä¼šæ³„éœ²ç§é’¥æœ¬èº«ã€‚</p><h3 id="ğŸ”¹-3-2-å¦‚ä½•éªŒè¯ç­¾åï¼Ÿ"><strong>ğŸ”¹ 3.2 å¦‚ä½•éªŒè¯ç­¾åï¼Ÿ</strong></h3><p>éªŒè¯ç­¾åæ—¶ï¼ŒDApp æˆ–æ™ºèƒ½åˆçº¦å¯ä»¥ä½¿ç”¨ <strong>å…¬é’¥æ¢å¤</strong>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> recoveredAddress = ethers.<span class="hljs-property">utils</span>.<span class="hljs-title function_">verifyMessage</span>(message, signature);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ç­¾ååœ°å€:&quot;</span>, recoveredAddress);<br></code></pre></td></tr></table></figure><p>å¦‚æœ <code>recoveredAddress === wallet.address</code>ï¼Œåˆ™è¯´æ˜ç­¾ååˆæ³•ã€‚</p><h3 id="ğŸ”¹-3-3-å¯èƒ½çš„æ”»å‡»"><strong>ğŸ”¹ 3.3 å¯èƒ½çš„æ”»å‡»</strong></h3><ol><li><strong>é‡æ”¾æ”»å‡»</strong>ï¼š<ul><li>æ”»å‡»è€…å¯é‡å¤ä½¿ç”¨ç­¾åå‘èµ·ç›¸åŒäº¤æ˜“ï¼ˆéœ€ nonce ä¿æŠ¤ï¼‰ã€‚</li></ul></li><li><strong>é’“é±¼æ”»å‡»</strong>ï¼š<ul><li>æ¶æ„ DApp å¯èƒ½è¯±å¯¼ç”¨æˆ·ç­¾åæ¶æ„æ¶ˆæ¯ï¼Œå¯¼è‡´èµ„äº§è¢«ç›—ï¼ˆEIP-712 ç»“æ„åŒ–ç­¾åå¯ä»¥é˜²æ­¢æ­¤é—®é¢˜ï¼‰ã€‚</li></ul></li></ol><hr><h2 id="4-æ€»ç»“"><strong>4. æ€»ç»“</strong></h2><table><thead><tr><th>ç­¾åç±»å‹</th><th>ç›®çš„</th><th>æ˜¯å¦ä¸Šé“¾</th><th>å…¸å‹ç”¨é€”</th></tr></thead><tbody><tr><td>äº¤æ˜“ç­¾å</td><td>æˆæƒäº¤æ˜“</td><td>âœ… éœ€è¦ä¸Šé“¾</td><td>ETH è½¬è´¦ã€è°ƒç”¨æ™ºèƒ½åˆçº¦</td></tr><tr><td>æ¶ˆæ¯ç­¾å</td><td>èº«ä»½è®¤è¯ã€é“¾ä¸‹æˆæƒ</td><td>âŒ ä¸ä¸Šé“¾</td><td>ç™»å½•éªŒè¯ã€NFT äº¤æ˜“æˆæƒ</td></tr><tr><td>EIP-712</td><td>ç»“æ„åŒ–æ•°æ®ç­¾åï¼Œé˜²é’“é±¼</td><td>âŒ ä¸ä¸Šé“¾</td><td>OpenSea NFT ç­¾åã€DApp æˆæƒ</td></tr></tbody></table><p>ğŸ’¡ <strong>ç§é’¥ç­¾åçš„æ ¸å¿ƒåœ¨äºï¼š</strong></p><ul><li><strong>åˆ©ç”¨ ECDSA ç®—æ³•ç”Ÿæˆ <code>(r, s, v)</code> ç­¾å</strong></li><li><strong>ä¿è¯èº«ä»½è®¤è¯ã€æ•°æ®å®Œæ•´æ€§</strong></li><li><strong>æ”¯æŒé“¾ä¸Šäº¤æ˜“å’Œé“¾ä¸‹æˆæƒ</strong></li><li><strong>é¿å…ç§é’¥æ³„éœ²ï¼Œä½¿ç”¨ EIP-712 æé«˜å®‰å…¨æ€§</strong></li></ul><h3 id="é’±åŒ…è¿æ¥çš„æœ¬è´¨"><strong>é’±åŒ…è¿æ¥çš„æœ¬è´¨</strong></h3><p>Web3 <strong>é’±åŒ…è¿æ¥ï¼ˆWallet Connectionï¼‰</strong> æ˜¯æŒ‡ <strong>å»ä¸­å¿ƒåŒ–åº”ç”¨ï¼ˆDAppï¼‰</strong> é€šè¿‡ Web3 APIï¼ˆå¦‚ <code>window.ethereum</code>ï¼‰ä¸ç”¨æˆ·çš„é’±åŒ…ï¼ˆå¦‚ MetaMaskã€WalletConnectï¼‰å»ºç«‹é€šä¿¡ï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥å®‰å…¨åœ°ç­¾åäº¤æ˜“ã€æˆæƒ DApp è®¿é—®èµ„äº§æˆ–è¿›è¡Œèº«ä»½è®¤è¯ã€‚</p><p>æœ¬è´¨ä¸Šï¼Œé’±åŒ…è¿æ¥æ˜¯ <strong>DApp ä¸é’±åŒ…ä¹‹é—´çš„é€šä¿¡åè®®</strong>ï¼Œå®ƒä¸æ¶‰åŠç§é’¥ä¼ è¾“ï¼Œè€Œæ˜¯è®© DApp é€šè¿‡ <strong>å…¬é’¥åœ°å€</strong> è¯†åˆ«ç”¨æˆ·ï¼Œå¹¶è®©ç”¨æˆ·ç”¨ç§é’¥ç­¾åæˆæƒè¯·æ±‚ã€‚</p><h1>é’±åŒ…è¿æ¥çš„æœ¬è´¨</h1><h2 id="1-é’±åŒ…è¿æ¥çš„æ ¸å¿ƒæ¦‚å¿µ"><strong>1. é’±åŒ…è¿æ¥çš„æ ¸å¿ƒæ¦‚å¿µ</strong></h2><h3 id="âœ…-å»ä¸­å¿ƒåŒ–èº«ä»½ï¼ˆDIDï¼‰">âœ… <strong>å»ä¸­å¿ƒåŒ–èº«ä»½ï¼ˆDIDï¼‰</strong></h3><ul><li>DApp ä¸å­˜å‚¨ç”¨æˆ·å¯†ç ï¼Œè€Œæ˜¯ä½¿ç”¨ <strong>é’±åŒ…åœ°å€</strong> ä½œä¸ºèº«ä»½æ ‡è¯†ã€‚</li><li><strong>ç”¨æˆ·é€šè¿‡é’±åŒ…ç­¾åè®¤è¯</strong>ï¼Œè¯æ˜è‡ªå·±æ˜¯åœ°å€çš„æ‹¥æœ‰è€…ã€‚</li></ul><h3 id="âœ…-é’±åŒ…ä¸æš´éœ²ç§é’¥">âœ… <strong>é’±åŒ…ä¸æš´éœ²ç§é’¥</strong></h3><ul><li><strong>é’±åŒ…åªè´Ÿè´£ç­¾å</strong>ï¼Œä¸ä¼šæš´éœ²ç§é’¥ã€‚</li><li><strong>DApp é€šè¿‡å…¬é’¥åœ°å€æ¢å¤ç­¾å</strong>ï¼ŒéªŒè¯ç”¨æˆ·èº«ä»½ã€‚</li></ul><h3 id="âœ…-é€šä¿¡åè®®">âœ… <strong>é€šä¿¡åè®®</strong></h3><ul><li><strong>EIP-1193 æ ‡å‡†</strong> å®šä¹‰äº† Web3 é’±åŒ…é€šä¿¡æ–¹å¼ã€‚</li><li>é€šè¿‡ <strong>JSON-RPC è¿œç¨‹è°ƒç”¨</strong> é’±åŒ… API è¿›è¡Œäº¤äº’ã€‚</li></ul><hr><h2 id="2-é’±åŒ…è¿æ¥çš„å·¥ä½œæµç¨‹"><strong>2. é’±åŒ…è¿æ¥çš„å·¥ä½œæµç¨‹</strong></h2><p>é’±åŒ…è¿æ¥ä¸»è¦åŒ…å« 4 ä¸ªå…³é”®æ­¥éª¤ï¼š</p><h3 id="ğŸ”¹-2-1-DApp-è¯·æ±‚è¿æ¥"><strong>ğŸ”¹ 2.1 DApp è¯·æ±‚è¿æ¥</strong></h3><p>DApp é€šè¿‡ <code>window.ethereum.request(&#123; method: 'eth_requestAccounts' &#125;)</code> è¯·æ±‚ç”¨æˆ·è¿æ¥é’±åŒ…ã€‚</p><h3 id="ğŸ”¹-2-2-ç”¨æˆ·æˆæƒ"><strong>ğŸ”¹ 2.2 ç”¨æˆ·æˆæƒ</strong></h3><p>é’±åŒ…å¼¹å‡ºæˆæƒçª—å£ï¼Œç”¨æˆ·ç‚¹å‡»â€œè¿æ¥â€åï¼ŒDApp è·å–é’±åŒ…åœ°å€ã€‚</p><h3 id="ğŸ”¹-2-3-DApp-è®°å½•ç”¨æˆ·åœ°å€"><strong>ğŸ”¹ 2.3 DApp è®°å½•ç”¨æˆ·åœ°å€</strong></h3><p>DApp å°† <code>walletAddress</code> å­˜å‚¨åœ¨ <strong>å‰ç«¯çŠ¶æ€</strong> æˆ– <strong>åç«¯æ•°æ®åº“</strong>ï¼Œç”¨äºèº«ä»½è¯†åˆ«ã€‚</p><h3 id="ğŸ”¹-2-4-äº¤æ˜“æˆ–ç­¾åäº¤äº’"><strong>ğŸ”¹ 2.4 äº¤æ˜“æˆ–ç­¾åäº¤äº’</strong></h3><p>ç”¨æˆ·å¯åœ¨ DApp å†…ï¼š</p><ol><li><strong>ç­¾åäº¤æ˜“ï¼ˆå¦‚ ETH è½¬è´¦ã€æ™ºèƒ½åˆçº¦è°ƒç”¨ï¼‰</strong></li><li><strong>ç­¾åæ¶ˆæ¯ï¼ˆå¦‚ DApp ç™»å½•éªŒè¯ï¼‰</strong></li></ol><p>ğŸ“Œ <strong>Mermaid åºåˆ—å›¾</strong></p><pre><code class=" mermaid">sequenceDiagram    participant DApp as å»ä¸­å¿ƒåŒ–åº”ç”¨(DApp)    participant User as ç”¨æˆ·    participant Wallet as Web3 é’±åŒ…    DApp-&gt;&gt;Wallet: è¿æ¥è¯·æ±‚ (eth_requestAccounts)    Wallet-&gt;&gt;User: å¼¹å‡ºè¿æ¥æˆæƒçª—å£    User-&gt;&gt;Wallet: æˆæƒè¿æ¥    Wallet-&gt;&gt;DApp: è¿”å›é’±åŒ…åœ°å€    DApp--&gt;&gt;User: è¿æ¥æˆåŠŸï¼Œç”¨æˆ·èº«ä»½è®¤è¯å®Œæˆ</code></pre><hr><h2 id="3-é’±åŒ…è¿æ¥çš„ä»£ç å®ç°"><strong>3. é’±åŒ…è¿æ¥çš„ä»£ç å®ç°</strong></h2><h3 id="ğŸ”¹-3-1-åŸºç¡€è¿æ¥"><strong>ğŸ”¹ 3.1 åŸºç¡€è¿æ¥</strong></h3><p>ä½¿ç”¨ <strong>MetaMask + ethers.js</strong> è¿æ¥é’±åŒ…ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">connectWallet</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">ethereum</span>) &#123;<br>        <span class="hljs-keyword">const</span> provider = <span class="hljs-keyword">new</span> ethers.<span class="hljs-property">providers</span>.<span class="hljs-title class_">Web3Provider</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">ethereum</span>);<br>        <span class="hljs-keyword">const</span> accounts = <span class="hljs-keyword">await</span> provider.<span class="hljs-title function_">send</span>(<span class="hljs-string">&quot;eth_requestAccounts&quot;</span>, []);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;é’±åŒ…åœ°å€:&quot;</span>, accounts[<span class="hljs-number">0</span>]);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;è¯·å®‰è£… MetaMask&quot;</span>);<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><hr><h3 id="ğŸ”¹-3-2-ç­¾åç™»å½•"><strong>ğŸ”¹ 3.2 ç­¾åç™»å½•</strong></h3><p>DApp é€šè¿‡ <strong>é’±åŒ…ç­¾å</strong> éªŒè¯ç”¨æˆ·èº«ä»½ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">signMessage</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> provider = <span class="hljs-keyword">new</span> ethers.<span class="hljs-property">providers</span>.<span class="hljs-title class_">Web3Provider</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">ethereum</span>);<br>    <span class="hljs-keyword">const</span> signer = provider.<span class="hljs-title function_">getSigner</span>();<br>    <span class="hljs-keyword">const</span> address = <span class="hljs-keyword">await</span> signer.<span class="hljs-title function_">getAddress</span>();<br>    <br>    <span class="hljs-keyword">const</span> message = <span class="hljs-string">`Login to MyDApp: <span class="hljs-subst">$&#123;<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString()&#125;</span>`</span>;<br>    <span class="hljs-keyword">const</span> signature = <span class="hljs-keyword">await</span> signer.<span class="hljs-title function_">signMessage</span>(message);<br><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ç”¨æˆ·åœ°å€:&quot;</span>, address);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ç­¾å:&quot;</span>, signature);<br>&#125;;<br></code></pre></td></tr></table></figure><p>âœ… <strong>åŸç†</strong>ï¼š</p><ul><li>é’±åŒ… <strong>ä¸æ³„éœ²ç§é’¥</strong>ï¼Œåªè¿”å›ç­¾åã€‚</li><li>DApp ä½¿ç”¨ <strong><code>ethers.utils.verifyMessage(message, signature)</code></strong> éªŒè¯èº«ä»½ã€‚</li></ul><hr><h3 id="ğŸ”¹-3-3-äº¤æ˜“ç­¾å"><strong>ğŸ”¹ 3.3 äº¤æ˜“ç­¾å</strong></h3><p>å¦‚æœç”¨æˆ·è¦ <strong>å‘é€äº¤æ˜“</strong>ï¼Œé’±åŒ…ä¼šå¼¹çª—ç¡®è®¤ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">sendTransaction</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> provider = <span class="hljs-keyword">new</span> ethers.<span class="hljs-property">providers</span>.<span class="hljs-title class_">Web3Provider</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">ethereum</span>);<br>    <span class="hljs-keyword">const</span> signer = provider.<span class="hljs-title function_">getSigner</span>();<br><br>    <span class="hljs-keyword">const</span> tx = <span class="hljs-keyword">await</span> signer.<span class="hljs-title function_">sendTransaction</span>(&#123;<br>        <span class="hljs-attr">to</span>: <span class="hljs-string">&quot;0xRecipientAddress&quot;</span>,<br>        <span class="hljs-attr">value</span>: ethers.<span class="hljs-property">utils</span>.<span class="hljs-title function_">parseEther</span>(<span class="hljs-string">&quot;0.01&quot;</span>),<br>    &#125;);<br><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;äº¤æ˜“å“ˆå¸Œ:&quot;</span>, tx.<span class="hljs-property">hash</span>);<br>&#125;;<br></code></pre></td></tr></table></figure><p>âœ… <strong>é’±åŒ…è¿æ¥åï¼ŒDApp å¯ä»¥è¯·æ±‚ç”¨æˆ·ç­¾åäº¤æ˜“ï¼Œå¹¶å‘é€åˆ°åŒºå—é“¾ï¼</strong></p><hr><h2 id="4-é’±åŒ…è¿æ¥çš„å®‰å…¨æ€§"><strong>4. é’±åŒ…è¿æ¥çš„å®‰å…¨æ€§</strong></h2><h3 id="âœ…-ä¸ºä»€ä¹ˆ-DApp-åªèƒ½è®¿é—®åœ°å€ï¼Œè€Œæ— æ³•è·å–ç§é’¥ï¼Ÿ">âœ… <strong>ä¸ºä»€ä¹ˆ DApp åªèƒ½è®¿é—®åœ°å€ï¼Œè€Œæ— æ³•è·å–ç§é’¥ï¼Ÿ</strong></h3><ul><li>é’±åŒ… <strong>ä½¿ç”¨ EIP-1193</strong> æ ‡å‡†ï¼Œåªå…è®¸ DApp é€šè¿‡ <code>eth_requestAccounts</code> è·å–åœ°å€ã€‚</li><li><strong>é’±åŒ…åªè¿”å›å…¬é’¥åœ°å€ï¼Œä¸æš´éœ²ç§é’¥</strong>ï¼Œæ‰€æœ‰æ“ä½œéƒ½ç”±ç”¨æˆ·æ‰‹åŠ¨ç¡®è®¤ã€‚</li></ul><h3 id="âŒ-å¯èƒ½çš„å®‰å…¨é£é™©">âŒ <strong>å¯èƒ½çš„å®‰å…¨é£é™©</strong></h3><ol><li><p><strong>æ¶æ„ DApp ä¼ªé€ æˆæƒ</strong></p><ul><li>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ <strong>EIP-712 ç»“æ„åŒ–ç­¾å</strong> é¿å…ç­¾åæ¬ºéª—æ”»å‡»ã€‚</li></ul></li><li><p><strong>å‰ç«¯åŠ«æŒæ”»å‡»</strong></p><ul><li>è§£å†³æ–¹æ¡ˆï¼šé¿å… <strong>ç›´æ¥ä¿¡ä»»å‰ç«¯</strong>ï¼Œåç«¯éœ€éªŒè¯ç­¾åã€‚</li></ul></li></ol><hr><h2 id="5-é’±åŒ…è¿æ¥çš„åº•å±‚åè®®"><strong>5. é’±åŒ…è¿æ¥çš„åº•å±‚åè®®</strong></h2><h3 id="ğŸ”¹-JSON-RPC-è°ƒç”¨"><strong>ğŸ”¹ JSON-RPC è°ƒç”¨</strong></h3><p>é’±åŒ…é€šè¿‡ <strong>JSON-RPC</strong> åè®®ä¸ DApp äº¤äº’ï¼Œä¸»è¦ APIï¼š</p><table><thead><tr><th>æ–¹æ³•</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>eth_requestAccounts</code></td><td>è¯·æ±‚ç”¨æˆ·è¿æ¥é’±åŒ…</td></tr><tr><td><code>eth_accounts</code></td><td>è·å–å·²è¿æ¥çš„é’±åŒ…åœ°å€</td></tr><tr><td><code>personal_sign</code></td><td>ç­¾åæ¶ˆæ¯</td></tr><tr><td><code>eth_sendTransaction</code></td><td>å‘é€äº¤æ˜“</td></tr></tbody></table><p>ğŸ“Œ <strong>ç¤ºä¾‹ JSON-RPC è°ƒç”¨</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;eth_requestAccounts&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>ğŸ“Œ <strong>ç¤ºä¾‹è¿”å›</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;jsonrpc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;0xYourWalletAddress&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><hr><h2 id="6-æ€»ç»“"><strong>6. æ€»ç»“</strong></h2><table><thead><tr><th><strong>æ ¸å¿ƒæ¦‚å¿µ</strong></th><th><strong>è§£é‡Š</strong></th></tr></thead><tbody><tr><td><strong>èº«ä»½è®¤è¯</strong></td><td>é€šè¿‡é’±åŒ…åœ°å€å’Œç­¾åè¿›è¡Œèº«ä»½éªŒè¯</td></tr><tr><td><strong>å»ä¸­å¿ƒåŒ–</strong></td><td>ä¸éœ€è¦ç”¨æˆ·åå¯†ç ï¼Œç”¨æˆ·å®Œå…¨æ§åˆ¶ç§é’¥</td></tr><tr><td><strong>äº¤æ˜“æˆæƒ</strong></td><td>ç”¨æˆ·ç”¨é’±åŒ…ç­¾åï¼Œç¡®è®¤äº¤æ˜“</td></tr><tr><td><strong>EIP-1193</strong></td><td>æ ‡å‡†åŒ–é’±åŒ…ä¸ DApp äº¤äº’æ–¹å¼</td></tr></tbody></table><p>âœ… <strong>DApp åªèƒ½è®¿é—®é’±åŒ…åœ°å€ï¼Œä¸ä¼šè·å–ç§é’¥</strong><br>âœ… <strong>ç”¨æˆ·é€šè¿‡ç­¾åæˆæƒï¼Œç¡®ä¿äº¤æ˜“å®‰å…¨</strong><br>âœ… <strong>é’±åŒ…è¿æ¥åï¼ŒDApp å¯ä¸åŒºå—é“¾äº¤äº’ï¼Œç”¨æˆ·å®Œå…¨æŒæ§èµ„äº§</strong></p><p>ğŸš€ <strong>é’±åŒ…è¿æ¥æ˜¯ Web3 å»ä¸­å¿ƒåŒ–èº«ä»½è®¤è¯çš„å…³é”®ï¼Œç¡®ä¿ç”¨æˆ·éšç§å’Œå®‰å…¨ï¼</strong> ğŸ”</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>aave1</title>
    <link href="/2025/02/09/aave1/"/>
    <url>/2025/02/09/aave1/</url>
    
    <content type="html"><![CDATA[<h1>Aaveå€Ÿè´·ä¸šåŠ¡çš„æ—¶åºå›¾</h1><pre><code class=" mermaid">sequenceDiagram    participant User as ç”¨æˆ·    participant LP as LendingPool    participant ERC20 as ERC20ä»£å¸åˆçº¦    participant aToken as aTokenåˆçº¦    participant DebtToken as å€ºåŠ¡ä»£å¸åˆçº¦    participant Liquidator as æ¸…ç®—è€…    %% å­˜æ¬¾æµç¨‹    Note over User,LP: å­˜æ¬¾æµç¨‹    User-&gt;&gt;LP: deposit(asset, amount, onBehalfOf, referralCode)    LP-&gt;&gt;ERC20: transferFrom(User, LP, amount)    LP-&gt;&gt;aToken: mint(onBehalfOf, amount)    LP--&gt;&gt;User: å­˜æ¬¾æˆåŠŸï¼ˆè·å¾—aTokenï¼‰    %% å€Ÿæ¬¾æµç¨‹    Note over User,LP: å€Ÿæ¬¾æµç¨‹    User-&gt;&gt;LP: borrow(asset, amount, interestRateMode, referralCode, onBehalfOf)    LP-&gt;&gt;DebtToken: mint(onBehalfOf, amount)    LP-&gt;&gt;ERC20: transfer(asset, User, amount)    LP--&gt;&gt;User: å€Ÿæ¬¾æˆåŠŸï¼ˆè·å¾—èµ„é‡‘ï¼‰    %% è¿˜æ¬¾æµç¨‹    Note over User,LP: è¿˜æ¬¾æµç¨‹    User-&gt;&gt;LP: repay(asset, amount, rateMode, onBehalfOf)    LP-&gt;&gt;ERC20: transferFrom(User, LP, amount)    LP-&gt;&gt;DebtToken: burn(onBehalfOf, amount)    LP--&gt;&gt;User: è¿˜æ¬¾æˆåŠŸ    %% æ¸…ç®—æµç¨‹ï¼ˆå½“å€Ÿæ¬¾äººæŠµæŠ¼ä¸è¶³æ—¶ï¼‰    Note over Liquidator,LP: æ¸…ç®—æµç¨‹    Liquidator-&gt;&gt;LP: liquidationCall(borrower, collateralAsset, debtAsset, debtToCover, receiveAToken)    LP-&gt;&gt;ERC20: transferFrom(Liquidator, LP, debtToCover)    LP-&gt;&gt;DebtToken: burn(borrower, debtToCover)    LP-&gt;&gt;aToken: redeem(borrower, liquidatedCollateral)    LP-&gt;&gt;Liquidator: transfer(collateralAsset, liquidatedCollateral)    LP--&gt;&gt;Liquidator: æ¸…ç®—å®Œæˆ</code></pre><h1>Aave å€Ÿè´·æ ¸å¿ƒè®¡ç®—é€»è¾‘åŠå…¬å¼ç¤ºä¾‹</h1><p>Aave åè®®å†…éƒ¨é‡‡ç”¨é«˜ç²¾åº¦æ•°å­¦è¿ç®—ï¼ˆé€šå¸¸ä½¿ç”¨ ray å•ä½ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>10</mn><mn>27</mn></msup></mrow><annotation encoding="application/x-tex">10^{27}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">27</span></span></span></span></span></span></span></span></span></span></span></span> ç²¾åº¦ï¼‰æ¥è®¡ç®—åˆ©ç‡ã€åˆ©æ¯ç´¯ç§¯ã€é£é™©æ§åˆ¶ç­‰ã€‚ä¸‹æ–‡åˆ—å‡ºäº†å„é¡¹ä¸»è¦è®¡ç®—å…¬å¼ï¼Œå¹¶é€šè¿‡å…·ä½“æ•°å€¼ç¤ºä¾‹åŠ ä»¥è¯´æ˜ã€‚</p><hr><h2 id="1-åˆ©ç‡è®¡ç®—">1. åˆ©ç‡è®¡ç®—</h2><h3 id="1-1-åˆ©ç”¨ç‡ï¼ˆUtilization-Rateï¼‰">1.1 åˆ©ç”¨ç‡ï¼ˆUtilization Rateï¼‰</h3><p>åˆ©ç”¨ç‡è¡¡é‡å‚¨å¤‡ä¸­å€Ÿæ¬¾é‡‘é¢æ‰€å çš„æ¯”ä¾‹ï¼Œå…¬å¼ä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>U</mi><mo>=</mo><mfrac><mtext>TotalÂ Borrows</mtext><mrow><mtext>AvailableÂ Liquidity</mtext><mo>+</mo><mtext>TotalÂ Borrows</mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">U = \frac{\text{Total Borrows}}{\text{Available Liquidity} + \text{Total Borrows}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">AvailableÂ Liquidity</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">TotalÂ Borrows</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">TotalÂ Borrows</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><strong>ç¤ºä¾‹</strong><br>å‡è®¾ï¼š</p><ul><li>å½“å‰å€Ÿæ¬¾æ€»é¢ï¼ˆTotal Borrowsï¼‰ = 300,000 USDC</li><li>å‚¨å¤‡ä¸­çš„å¯ç”¨æµåŠ¨æ€§ï¼ˆAvailable Liquidityï¼‰ = 700,000 USDC</li></ul><p>åˆ™è®¡ç®—åˆ©ç”¨ç‡ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>U</mi><mo>=</mo><mfrac><mrow><mn>300</mn><mtext>â€‰</mtext><mn>000</mn></mrow><mrow><mn>700</mn><mtext>â€‰</mtext><mn>000</mn><mo>+</mo><mn>300</mn><mtext>â€‰</mtext><mn>000</mn></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>300</mn><mtext>â€‰</mtext><mn>000</mn></mrow><mrow><mn>1</mn><mtext>â€‰</mtext><mn>000</mn><mtext>â€‰</mtext><mn>000</mn></mrow></mfrac><mo>=</mo><mn>0.3</mn><mspace width="1em"><mo stretchy="false">(</mo><mn>30</mn><mi mathvariant="normal">%</mi><mo stretchy="false">)</mo></mspace></mrow><annotation encoding="application/x-tex">U = \frac{300\,000}{700\,000 + 300\,000} = \frac{300\,000}{1\,000\,000} = 0.3 \quad (30\%)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">700</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">300</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">300</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">300</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.3</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord">30%</span><span class="mclose">)</span></span></span></span></span></p><hr><h3 id="1-2-å€Ÿæ¬¾åˆ©ç‡ï¼ˆBorrow-Ratesï¼‰">1.2 å€Ÿæ¬¾åˆ©ç‡ï¼ˆBorrow Ratesï¼‰</h3><p>Aave åˆ†ä¸º<strong>å¯å˜å€Ÿæ¬¾åˆ©ç‡</strong>å’Œ<strong>ç¨³å®šå€Ÿæ¬¾åˆ©ç‡</strong>ï¼Œé€šå¸¸å‡é‡‡ç”¨åˆ†æ®µæ¨¡å‹ã€‚</p><h4 id="1-2-1-å¯å˜å€Ÿæ¬¾åˆ©ç‡ï¼ˆVariable-Borrow-Rateï¼‰">1.2.1 å¯å˜å€Ÿæ¬¾åˆ©ç‡ï¼ˆVariable Borrow Rateï¼‰</h4><p>å…¬å¼ä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>VariableÂ BorrowÂ Rate</mtext><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>BaseÂ VariableÂ Rate</mtext><mo>+</mo><mtext>VariableÂ RateÂ Slope1</mtext><mo>â‹…</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>U</mi><msub><mi>U</mi><mtext>opt</mtext></msub></mfrac></mstyle><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>U</mi><mo>â‰¤</mo><msub><mi>U</mi><mtext>opt</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>BaseÂ VariableÂ Rate</mtext><mo>+</mo><mtext>VariableÂ RateÂ Slope1</mtext><mo>+</mo><mtext>VariableÂ RateÂ Slope2</mtext><mo>â‹…</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>U</mi><mo>âˆ’</mo><msub><mi>U</mi><mtext>opt</mtext></msub></mrow><mrow><mn>1</mn><mo>âˆ’</mo><msub><mi>U</mi><mtext>opt</mtext></msub></mrow></mfrac></mstyle><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>U</mi><mo>&gt;</mo><msub><mi>U</mi><mtext>opt</mtext></msub></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{Variable Borrow Rate} =\begin{cases}\text{Base Variable Rate} + \text{Variable Rate Slope1} \cdot \dfrac{U}{U_{\text{opt}}}, &amp; U \leq U_{\text{opt}} \\\text{Base Variable Rate} + \text{Variable Rate Slope1} + \text{Variable Rate Slope2} \cdot \dfrac{U - U_{\text{opt}}}{1 - U_{\text{opt}}}, &amp; U &gt; U_{\text{opt}}\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">VariableÂ BorrowÂ Rate</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.8em;vertical-align:-2.15em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.9em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-1.892em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.616em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.616em" style="width:0.8889em" viewbox="0 0 888.89 616" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V616 H384z M384 0 H504 V616 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.616em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.616em" style="width:0.8889em" viewbox="0 0 888.89 616" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V616 H384z M384 0 H504 V616 H384z"/></svg></span></span><span style="top:-4.9em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5824em;"><span style="top:-4.5824em;"><span class="pstrut" style="height:3.3603em;"></span><span class="mord"><span class="mord text"><span class="mord">BaseÂ VariableÂ Rate</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">VariableÂ RateÂ Slope1</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.3603em;"></span><span class="mord"><span class="mord text"><span class="mord">BaseÂ VariableÂ Rate</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">VariableÂ RateÂ Slope1</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">VariableÂ RateÂ Slope2</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.0824em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5824em;"><span style="top:-4.5824em;"><span class="pstrut" style="height:3.3603em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.3603em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.0824em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><strong>ç¤ºä¾‹ 1</strong>ï¼ˆå½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>â‰¤</mo><msub><mi>U</mi><mtext>opt</mtext></msub></mrow><annotation encoding="application/x-tex">U \leq U_{\text{opt}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼š<br>å‡è®¾å‚æ•°ï¼š</p><ul><li>åŸºå‡†å¯å˜åˆ©ç‡ï¼ˆBase Variable Rateï¼‰ = 2%</li><li>æ–œç‡1ï¼ˆVariable Rate Slope1ï¼‰ = 6%</li><li>æœ€ä¼˜åˆ©ç”¨ç‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mtext>opt</mtext></msub><mo>=</mo><mn>80</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">U_{\text{opt}} = 80\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">80%</span></span></span></span> (å³ 0.8)</li><li>å½“å‰åˆ©ç”¨ç‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><mn>30</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">U = 30\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">30%</span></span></span></span> (å³ 0.3)</li></ul><p>è®¡ç®—ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>VariableÂ BorrowÂ Rate</mtext><mo>=</mo><mn>0.02</mn><mo>+</mo><mn>0.06</mn><mo>Ã—</mo><mfrac><mn>0.3</mn><mn>0.8</mn></mfrac><mo>=</mo><mn>0.02</mn><mo>+</mo><mn>0.06</mn><mo>Ã—</mo><mn>0.375</mn><mo>=</mo><mn>0.02</mn><mo>+</mo><mn>0.0225</mn><mo>=</mo><mn>0.0425</mn><mspace width="1em"><mo stretchy="false">(</mo><mn>4.25</mn><mi mathvariant="normal">%</mi><mtext>Â å¹´åˆ©ç‡</mtext><mo stretchy="false">)</mo></mspace></mrow><annotation encoding="application/x-tex">\text{Variable Borrow Rate} = 0.02 + 0.06 \times \frac{0.3}{0.8} = 0.02 + 0.06 \times 0.375 = 0.02 + 0.0225 = 0.0425 \quad (4.25\%\ \text{å¹´åˆ©ç‡})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">VariableÂ BorrowÂ Rate</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.02</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.06</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.8</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.02</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.06</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.375</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.02</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.0225</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.0425</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord">4.25%</span><span class="mspace">Â </span><span class="mord text"><span class="mord cjk_fallback">å¹´åˆ©ç‡</span></span><span class="mclose">)</span></span></span></span></span></p><p><strong>ç¤ºä¾‹ 2</strong>ï¼ˆå½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>&gt;</mo><msub><mi>U</mi><mtext>opt</mtext></msub></mrow><annotation encoding="application/x-tex">U &gt; U_{\text{opt}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼š<br>å‡è®¾å‚æ•°ä¸å˜ï¼Œä½†å½“å‰åˆ©ç”¨ç‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><mn>90</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">U = 90\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">90%</span></span></span></span> (å³ 0.9)<br>è®¡ç®—ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>VariableÂ BorrowÂ Rate</mtext><mo>=</mo><mn>0.02</mn><mo>+</mo><mn>0.06</mn><mo>+</mo><mn>1.00</mn><mo>Ã—</mo><mfrac><mrow><mn>0.9</mn><mo>âˆ’</mo><mn>0.8</mn></mrow><mrow><mn>1</mn><mo>âˆ’</mo><mn>0.8</mn></mrow></mfrac><mo>=</mo><mn>0.08</mn><mo>+</mo><mn>1.00</mn><mo>Ã—</mo><mfrac><mn>0.1</mn><mn>0.2</mn></mfrac><mo>=</mo><mn>0.08</mn><mo>+</mo><mn>0.5</mn><mo>=</mo><mn>0.58</mn><mspace width="1em"><mo stretchy="false">(</mo><mn>58</mn><mi mathvariant="normal">%</mi><mtext>Â å¹´åˆ©ç‡</mtext><mo stretchy="false">)</mo></mspace></mrow><annotation encoding="application/x-tex">\text{Variable Borrow Rate} = 0.02 + 0.06 + 1.00 \times \frac{0.9 - 0.8}{1 - 0.8} = 0.08 + 1.00 \times \frac{0.1}{0.2} = 0.08 + 0.5 = 0.58 \quad (58\%\ \text{å¹´åˆ©ç‡})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">VariableÂ BorrowÂ Rate</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.02</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.06</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.00</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.8</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.9</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.08</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.00</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.08</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.5</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.58</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord">58%</span><span class="mspace">Â </span><span class="mord text"><span class="mord cjk_fallback">å¹´åˆ©ç‡</span></span><span class="mclose">)</span></span></span></span></span></p><blockquote><p><strong>æ³¨æ„ï¼š</strong> ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼ŒVariable Rate Slope2 å–å€¼ä¸º 100%ï¼ˆ1.00ï¼‰ï¼Œå®é™…å‚æ•°ç”±åè®®é…ç½®å†³å®šã€‚</p></blockquote><h4 id="1-2-2-ç¨³å®šå€Ÿæ¬¾åˆ©ç‡ï¼ˆStable-Borrow-Rateï¼‰">1.2.2 ç¨³å®šå€Ÿæ¬¾åˆ©ç‡ï¼ˆStable Borrow Rateï¼‰</h4><p>å…¬å¼ä¸å¯å˜å€Ÿæ¬¾åˆ©ç‡ç±»ä¼¼ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>StableÂ BorrowÂ Rate</mtext><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>BaseÂ StableÂ Rate</mtext><mo>+</mo><mtext>StableÂ RateÂ Slope1</mtext><mo>â‹…</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>U</mi><msub><mi>U</mi><mtext>opt</mtext></msub></mfrac></mstyle><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>U</mi><mo>â‰¤</mo><msub><mi>U</mi><mtext>opt</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>BaseÂ StableÂ Rate</mtext><mo>+</mo><mtext>StableÂ RateÂ Slope1</mtext><mo>+</mo><mtext>StableÂ RateÂ Slope2</mtext><mo>â‹…</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>U</mi><mo>âˆ’</mo><msub><mi>U</mi><mtext>opt</mtext></msub></mrow><mrow><mn>1</mn><mo>âˆ’</mo><msub><mi>U</mi><mtext>opt</mtext></msub></mrow></mfrac></mstyle><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>U</mi><mo>&gt;</mo><msub><mi>U</mi><mtext>opt</mtext></msub></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{Stable Borrow Rate} =\begin{cases}\text{Base Stable Rate} + \text{Stable Rate Slope1} \cdot \dfrac{U}{U_{\text{opt}}}, &amp; U \leq U_{\text{opt}} \\\text{Base Stable Rate} + \text{Stable Rate Slope1} + \text{Stable Rate Slope2} \cdot \dfrac{U - U_{\text{opt}}}{1 - U_{\text{opt}}}, &amp; U &gt; U_{\text{opt}}\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">StableÂ BorrowÂ Rate</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.8em;vertical-align:-2.15em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.9em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-1.892em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.616em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.616em" style="width:0.8889em" viewbox="0 0 888.89 616" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V616 H384z M384 0 H504 V616 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.616em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.616em" style="width:0.8889em" viewbox="0 0 888.89 616" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V616 H384z M384 0 H504 V616 H384z"/></svg></span></span><span style="top:-4.9em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5824em;"><span style="top:-4.5824em;"><span class="pstrut" style="height:3.3603em;"></span><span class="mord"><span class="mord text"><span class="mord">BaseÂ StableÂ Rate</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">StableÂ RateÂ Slope1</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.3603em;"></span><span class="mord"><span class="mord text"><span class="mord">BaseÂ StableÂ Rate</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">StableÂ RateÂ Slope1</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">StableÂ RateÂ Slope2</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.0824em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5824em;"><span style="top:-4.5824em;"><span class="pstrut" style="height:3.3603em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.3603em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.0824em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><strong>ç¤ºä¾‹</strong>ï¼š<br>å‡è®¾å‚æ•°ï¼š</p><ul><li>åŸºå‡†ç¨³å®šåˆ©ç‡ï¼ˆBase Stable Rateï¼‰ = 3%</li><li>ç¨³å®šåˆ©ç‡æ–œç‡1ï¼ˆStable Rate Slope1ï¼‰ = 8%</li><li>ç¨³å®šåˆ©ç‡æ–œç‡2ï¼ˆStable Rate Slope2ï¼‰ = 120%</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mtext>opt</mtext></msub><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">U_{\text{opt}} = 0.8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.8</span></span></span></span></li></ul><p><strong>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">U = 0.3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.3</span></span></span></span> æ—¶</strong>ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>StableÂ BorrowÂ Rate</mtext><mo>=</mo><mn>0.03</mn><mo>+</mo><mn>0.08</mn><mo>Ã—</mo><mfrac><mn>0.3</mn><mn>0.8</mn></mfrac><mo>=</mo><mn>0.03</mn><mo>+</mo><mn>0.08</mn><mo>Ã—</mo><mn>0.375</mn><mo>=</mo><mn>0.03</mn><mo>+</mo><mn>0.03</mn><mo>=</mo><mn>0.06</mn><mspace width="1em"><mo stretchy="false">(</mo><mn>6</mn><mi mathvariant="normal">%</mi><mtext>Â å¹´åˆ©ç‡</mtext><mo stretchy="false">)</mo></mspace></mrow><annotation encoding="application/x-tex">\text{Stable Borrow Rate} = 0.03 + 0.08 \times \frac{0.3}{0.8} = 0.03 + 0.08 \times 0.375 = 0.03 + 0.03 = 0.06 \quad (6\%\ \text{å¹´åˆ©ç‡})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">StableÂ BorrowÂ Rate</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.03</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.08</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.8</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.03</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.08</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.375</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.03</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.03</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.06</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord">6%</span><span class="mspace">Â </span><span class="mord text"><span class="mord cjk_fallback">å¹´åˆ©ç‡</span></span><span class="mclose">)</span></span></span></span></span></p><p><strong>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">U = 0.9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.9</span></span></span></span> æ—¶</strong>ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>StableÂ BorrowÂ Rate</mtext><mo>=</mo><mn>0.03</mn><mo>+</mo><mn>0.08</mn><mo>+</mo><mn>1.20</mn><mo>Ã—</mo><mfrac><mrow><mn>0.9</mn><mo>âˆ’</mo><mn>0.8</mn></mrow><mn>0.2</mn></mfrac><mo>=</mo><mn>0.11</mn><mo>+</mo><mn>1.20</mn><mo>Ã—</mo><mn>0.5</mn><mo>=</mo><mn>0.11</mn><mo>+</mo><mn>0.6</mn><mo>=</mo><mn>0.71</mn><mspace width="1em"><mo stretchy="false">(</mo><mn>71</mn><mi mathvariant="normal">%</mi><mtext>Â å¹´åˆ©ç‡</mtext><mo stretchy="false">)</mo></mspace></mrow><annotation encoding="application/x-tex">\text{Stable Borrow Rate} = 0.03 + 0.08 + 1.20 \times \frac{0.9 - 0.8}{0.2} = 0.11 + 1.20 \times 0.5 = 0.11 + 0.6 = 0.71 \quad (71\%\ \text{å¹´åˆ©ç‡})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">StableÂ BorrowÂ Rate</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.03</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.08</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.20</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.9</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.11</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.20</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.5</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.11</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.6</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.71</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord">71%</span><span class="mspace">Â </span><span class="mord text"><span class="mord cjk_fallback">å¹´åˆ©ç‡</span></span><span class="mclose">)</span></span></span></span></span></p><hr><h3 id="1-3-å­˜æ¬¾åˆ©ç‡ï¼ˆLiquidity-Rateï¼‰">1.3 å­˜æ¬¾åˆ©ç‡ï¼ˆLiquidity Rateï¼‰</h3><p>å­˜æ¬¾åˆ©ç‡è¡¨ç¤ºå­˜æ¬¾è€…è·å¾—çš„æ”¶ç›Šï¼Œå…¶è®¡ç®—ç»¼åˆäº†ç¨³å®šå’Œå¯å˜å€Ÿæ¬¾çš„åˆ©ç‡ï¼Œå…¬å¼ä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>LiquidityÂ Rate</mtext><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">(</mo><mfrac><mrow><mtext>StableÂ Borrows</mtext><mo>Ã—</mo><mtext>StableÂ BorrowÂ Rate</mtext><mo>+</mo><mtext>VariableÂ Borrows</mtext><mo>Ã—</mo><mtext>VariableÂ BorrowÂ Rate</mtext></mrow><mtext>TotalÂ Borrows</mtext></mfrac><mo fence="true">)</mo></mrow><mo>Ã—</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>âˆ’</mo><mtext>ReserveÂ Factor</mtext><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ifÂ TotalÂ Borrows</mtext><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ifÂ TotalÂ Borrows</mtext><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{Liquidity Rate} =\begin{cases}\displaystyle \left(\frac{\text{Stable Borrows} \times \text{Stable Borrow Rate} + \text{Variable Borrows} \times \text{Variable Borrow Rate}}{\text{Total Borrows}}\right) \times \left(1 - \text{Reserve Factor}\right), &amp; \text{if Total Borrows} &gt; 0 \\0, &amp; \text{if Total Borrows} = 0\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">LiquidityÂ Rate</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.84em;vertical-align:-1.67em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.5em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-2.492em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.016em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:0.8889em" viewbox="0 0 888.89 16" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.016em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:0.8889em" viewbox="0 0 888.89 16" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"/></svg></span></span><span style="top:-4.3em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.17em;"><span style="top:-4.17em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">TotalÂ Borrows</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">StableÂ Borrows</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">StableÂ BorrowÂ Rate</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">VariableÂ Borrows</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">VariableÂ BorrowÂ Rate</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">ReserveÂ Factor</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span></span></span><span style="top:-2.212em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.67em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.17em;"><span style="top:-4.17em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord text"><span class="mord">ifÂ TotalÂ Borrows</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-2.212em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord text"><span class="mord">ifÂ TotalÂ Borrows</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.67em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><strong>ç¤ºä¾‹</strong><br>å‡è®¾ï¼š</p><ul><li>æ€»å€Ÿæ¬¾é¢ï¼ˆTotal Borrowsï¼‰ = 1,000,000 USDC</li><li>ç¨³å®šå€Ÿæ¬¾ï¼ˆStable Borrowsï¼‰ = 600,000 USDCï¼Œåˆ©ç‡ä¸º 6%</li><li>å¯å˜å€Ÿæ¬¾ï¼ˆVariable Borrowsï¼‰ = 400,000 USDCï¼Œåˆ©ç‡ä¸º 4%</li><li>åè®®å‚¨å¤‡æ¯”ä¾‹ï¼ˆReserve Factorï¼‰ = 10% (0.10)</li></ul><p>è®¡ç®—ï¼š</p><ol><li><p>åŠ æƒå€Ÿæ¬¾åˆ©ç‡ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mn>600</mn><mtext>â€‰</mtext><mn>000</mn><mo>Ã—</mo><mn>0.06</mn><mo>+</mo><mn>400</mn><mtext>â€‰</mtext><mn>000</mn><mo>Ã—</mo><mn>0.04</mn></mrow><mrow><mn>1</mn><mtext>â€‰</mtext><mn>000</mn><mtext>â€‰</mtext><mn>000</mn></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>36</mn><mtext>â€‰</mtext><mn>000</mn><mo>+</mo><mn>16</mn><mtext>â€‰</mtext><mn>000</mn></mrow><mrow><mn>1</mn><mtext>â€‰</mtext><mn>000</mn><mtext>â€‰</mtext><mn>000</mn></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>52</mn><mtext>â€‰</mtext><mn>000</mn></mrow><mrow><mn>1</mn><mtext>â€‰</mtext><mn>000</mn><mtext>â€‰</mtext><mn>000</mn></mrow></mfrac><mo>=</mo><mn>0.052</mn><mspace width="1em"><mo stretchy="false">(</mo><mn>5.2</mn><mi mathvariant="normal">%</mi><mo stretchy="false">)</mo></mspace></mrow><annotation encoding="application/x-tex">\frac{600\,000 \times 0.06 + 400\,000 \times 0.04}{1\,000\,000} = \frac{36\,000 + 16\,000}{1\,000\,000} = \frac{52\,000}{1\,000\,000} = 0.052 \quad (5.2\%)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">600</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.06</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">400</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.04</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">36</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">16</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">52</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.052</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord">5.2%</span><span class="mclose">)</span></span></span></span></span></p></li><li><p>æ‰£é™¤å‚¨å¤‡å› å­åçš„å­˜æ¬¾åˆ©ç‡ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>LiquidityÂ Rate</mtext><mo>=</mo><mn>0.052</mn><mo>Ã—</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mn>0.10</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0.052</mn><mo>Ã—</mo><mn>0.90</mn><mo>=</mo><mn>0.0468</mn><mspace width="1em"><mo stretchy="false">(</mo><mn>4.68</mn><mi mathvariant="normal">%</mi><mtext>Â å¹´åˆ©ç‡</mtext><mo stretchy="false">)</mo></mspace></mrow><annotation encoding="application/x-tex">\text{Liquidity Rate} = 0.052 \times (1 - 0.10) = 0.052 \times 0.90 = 0.0468 \quad (4.68\%\ \text{å¹´åˆ©ç‡})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">LiquidityÂ Rate</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.052</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.10</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.052</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.90</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.0468</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord">4.68%</span><span class="mspace">Â </span><span class="mord text"><span class="mord cjk_fallback">å¹´åˆ©ç‡</span></span><span class="mclose">)</span></span></span></span></span></p></li></ol><hr><h2 id="2-åˆ©æ¯ç´¯ç§¯ä¸æŒ‡æ•°æ›´æ–°">2. åˆ©æ¯ç´¯ç§¯ä¸æŒ‡æ•°æ›´æ–°</h2><p>ä¸ºäº†ç²¾ç¡®è¿½è¸ªåˆ©æ¯ç´¯ç§¯ï¼ŒAave ä½¿ç”¨<strong>æŒ‡æ•°</strong>æ›´æ–°å­˜æ¬¾å’Œå€Ÿæ¬¾çŠ¶æ€ã€‚ä¸‹é¢å…¬å¼ä¸­å®é™…è®¡ç®—å‡åœ¨é«˜ç²¾åº¦ï¼ˆray å•ä½ï¼‰ä¸‹è¿›è¡Œï¼Œä½†ç¤ºä¾‹ä¸­ä¸ºä¾¿äºç†è§£ï¼Œé‡‡ç”¨ç®€åŒ–çš„åè¿›åˆ¶è¡¨ç¤ºã€‚</p><h3 id="2-1-æµåŠ¨æ€§æŒ‡æ•°ï¼ˆLiquidity-Indexï¼‰æ›´æ–°">2.1 æµåŠ¨æ€§æŒ‡æ•°ï¼ˆLiquidity Indexï¼‰æ›´æ–°</h3><p>å…¬å¼ä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>newLiquidityIndex</mtext><mo>=</mo><mtext>liquidityIndex</mtext><mo>Ã—</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mfrac><mrow><mtext>LiquidityÂ Rate</mtext><mo>Ã—</mo><mi mathvariant="normal">Î”</mi><mi>t</mi></mrow><mtext>RAY</mtext></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{newLiquidityIndex} = \text{liquidityIndex} \times \left(1 + \frac{\text{Liquidity Rate} \times \Delta t}{\text{RAY}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">newLiquidityIndex</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">liquidityIndex</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">RAY</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">LiquidityÂ Rate</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Î”</span><span class="mord mathnormal">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p><p>å…¶ä¸­ï¼š</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î”</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Î”</span><span class="mord mathnormal">t</span></span></span></span> ä¸ºè‡ªä¸Šæ¬¡æ›´æ–°ä»¥æ¥çš„æ—¶é—´ï¼ˆç§’ï¼‰</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>RAY</mtext><mo>=</mo><msup><mn>10</mn><mn>27</mn></msup></mrow><annotation encoding="application/x-tex">\text{RAY} = 10^{27}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">RAY</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">27</span></span></span></span></span></span></span></span></span></span></span></span>ï¼ˆå®é™…è®¡ç®—ä¸­ï¼Œåˆ©ç‡å’ŒæŒ‡æ•°å‡ä»¥ ray è¡¨ç¤ºï¼‰</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼ˆç®€åŒ–ç‰ˆï¼Œä¸è€ƒè™‘ ray ç¼©æ”¾ï¼‰<br>å‡è®¾ï¼š</p><ul><li>ä¸Šä¸€æ—¶åˆ»æµåŠ¨æ€§æŒ‡æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>liquidityIndex</mtext><mo>=</mo><mn>1.0</mn></mrow><annotation encoding="application/x-tex">\text{liquidityIndex} = 1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">liquidityIndex</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.0</span></span></span></span></li><li>å­˜æ¬¾åˆ©ç‡ä¸º 5% å¹´åŒ–ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">r = 0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.05</span></span></span></span>ï¼‰</li><li>æ—¶é—´é—´éš” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î”</mi><mi>t</mi><mo>=</mo><mn>86</mn><mtext>â€‰</mtext><mn>400</mn></mrow><annotation encoding="application/x-tex">\Delta t = 86\,400</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Î”</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">86</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">400</span></span></span></span> ç§’ï¼ˆ1 å¤©ï¼‰</li></ul><p>é¦–å…ˆï¼Œå°†å¹´åŒ–åˆ©ç‡è½¬æ¢ä¸ºæ¯ç§’åˆ©ç‡ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>r</mi><mtext>perÂ second</mtext></msub><mo>=</mo><mfrac><mn>0.05</mn><mrow><mn>365</mn><mo>Ã—</mo><mn>24</mn><mo>Ã—</mo><mn>3600</mn></mrow></mfrac><mo>â‰ˆ</mo><mfrac><mn>0.05</mn><mrow><mn>31</mn><mtext>â€‰</mtext><mn>536</mn><mtext>â€‰</mtext><mn>000</mn></mrow></mfrac><mo>â‰ˆ</mo><mn>1.585</mn><mo>Ã—</mo><msup><mn>10</mn><mrow><mo>âˆ’</mo><mn>9</mn></mrow></msup></mrow><annotation encoding="application/x-tex">r_{\text{per second}} = \frac{0.05}{365 \times 24 \times 3600} \approx \frac{0.05}{31\,536\,000} \approx 1.585 \times 10^{-9}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">perÂ second</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">365</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">24</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">3600</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.05</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">31</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">536</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.05</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.585</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>æ—¥å¢é‡ä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>1.585</mn><mo>Ã—</mo><msup><mn>10</mn><mrow><mo>âˆ’</mo><mn>9</mn></mrow></msup><mo>Ã—</mo><mn>86</mn><mtext>â€‰</mtext><mn>400</mn><mo>â‰ˆ</mo><mn>0.000137</mn></mrow><annotation encoding="application/x-tex">1.585 \times 10^{-9} \times 86\,400 \approx 0.000137</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.585</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">86</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">400</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.000137</span></span></span></span></span></p><p>æ›´æ–°åçš„æµåŠ¨æ€§æŒ‡æ•°ä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>newLiquidityIndex</mtext><mo>=</mo><mn>1.0</mn><mo>Ã—</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>0.000137</mn><mo stretchy="false">)</mo><mo>â‰ˆ</mo><mn>1.000137</mn></mrow><annotation encoding="application/x-tex">\text{newLiquidityIndex} = 1.0 \times (1 + 0.000137) \approx 1.000137</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">newLiquidityIndex</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.000137</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.000137</span></span></span></span></span></p><blockquote><p><strong>å¤‡æ³¨</strong>ï¼šåœ¨å®é™…åˆçº¦ä¸­æ‰€æœ‰æ•°å€¼å‡ä¹˜ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>10</mn><mn>27</mn></msup></mrow><annotation encoding="application/x-tex">10^{27}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">27</span></span></span></span></span></span></span></span></span></span></span></span> è¡¨ç¤ºï¼Œç¡®ä¿ç²¾åº¦ã€‚</p></blockquote><h3 id="2-2-å¯å˜å€Ÿæ¬¾æŒ‡æ•°ï¼ˆVariable-Borrow-Indexï¼‰æ›´æ–°">2.2 å¯å˜å€Ÿæ¬¾æŒ‡æ•°ï¼ˆVariable Borrow Indexï¼‰æ›´æ–°</h3><p>å…¬å¼ç±»ä¼¼ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>newVariableBorrowIndex</mtext><mo>=</mo><mtext>variableBorrowIndex</mtext><mo>Ã—</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mfrac><mrow><mtext>VariableÂ BorrowÂ Rate</mtext><mo>Ã—</mo><mi mathvariant="normal">Î”</mi><mi>t</mi></mrow><mtext>RAY</mtext></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{newVariableBorrowIndex} = \text{variableBorrowIndex} \times \left(1 + \frac{\text{Variable Borrow Rate} \times \Delta t}{\text{RAY}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">newVariableBorrowIndex</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">variableBorrowIndex</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">RAY</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">VariableÂ BorrowÂ Rate</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Î”</span><span class="mord mathnormal">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p><p><strong>ç¤ºä¾‹</strong>ï¼ˆç®€åŒ–ç‰ˆï¼‰<br>å‡è®¾ï¼š</p><ul><li>åˆå§‹å¯å˜å€Ÿæ¬¾æŒ‡æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>variableBorrowIndex</mtext><mo>=</mo><mn>1.0</mn></mrow><annotation encoding="application/x-tex">\text{variableBorrowIndex} = 1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">variableBorrowIndex</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.0</span></span></span></span></li><li>å¯å˜å€Ÿæ¬¾å¹´åŒ–åˆ©ç‡ä¸º 4%ï¼ˆå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0.04</mn></mrow><annotation encoding="application/x-tex">r = 0.04</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.04</span></span></span></span>ï¼‰</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î”</mi><mi>t</mi><mo>=</mo><mn>86</mn><mtext>â€‰</mtext><mn>400</mn></mrow><annotation encoding="application/x-tex">\Delta t = 86\,400</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Î”</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">86</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">400</span></span></span></span> ç§’ï¼ˆ1 å¤©ï¼‰</li></ul><p>è®¡ç®—æ¯ç§’åˆ©ç‡ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>r</mi><mtext>perÂ second</mtext></msub><mo>=</mo><mfrac><mn>0.04</mn><mrow><mn>31</mn><mtext>â€‰</mtext><mn>536</mn><mtext>â€‰</mtext><mn>000</mn></mrow></mfrac><mo>â‰ˆ</mo><mn>1.268</mn><mo>Ã—</mo><msup><mn>10</mn><mrow><mo>âˆ’</mo><mn>9</mn></mrow></msup></mrow><annotation encoding="application/x-tex">r_{\text{per second}} = \frac{0.04}{31\,536\,000} \approx 1.268 \times 10^{-9}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">perÂ second</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">31</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">536</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.04</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.268</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>æ—¥å¢é‡ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>1.268</mn><mo>Ã—</mo><msup><mn>10</mn><mrow><mo>âˆ’</mo><mn>9</mn></mrow></msup><mo>Ã—</mo><mn>86</mn><mtext>â€‰</mtext><mn>400</mn><mo>â‰ˆ</mo><mn>0.000109</mn></mrow><annotation encoding="application/x-tex">1.268 \times 10^{-9} \times 86\,400 \approx 0.000109</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.268</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">86</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">400</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.000109</span></span></span></span></span></p><p>æ›´æ–°åçš„å¯å˜å€Ÿæ¬¾æŒ‡æ•°ä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>newVariableBorrowIndex</mtext><mo>=</mo><mn>1.0</mn><mo>Ã—</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>0.000109</mn><mo stretchy="false">)</mo><mo>â‰ˆ</mo><mn>1.000109</mn></mrow><annotation encoding="application/x-tex">\text{newVariableBorrowIndex} = 1.0 \times (1 + 0.000109) \approx 1.000109</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">newVariableBorrowIndex</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.000109</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.000109</span></span></span></span></span></p><hr><h2 id="3-å¥åº·å› å­ï¼ˆHealth-Factorï¼‰è®¡ç®—">3. å¥åº·å› å­ï¼ˆHealth Factorï¼‰è®¡ç®—</h2><p>å¥åº·å› å­ç”¨äºè¡¡é‡å€Ÿæ¬¾äººè´¦æˆ·å®‰å…¨æ€§ï¼Œå…¶è®¡ç®—å…¬å¼ä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>HealthÂ Factor</mtext><mo>=</mo><mfrac><mrow><mtext>CollateralÂ Value</mtext><mo>Ã—</mo><mtext>LiquidationÂ Threshold</mtext></mrow><mtext>TotalÂ BorrowedÂ Value</mtext></mfrac></mrow><annotation encoding="application/x-tex">\text{Health Factor} = \frac{\text{Collateral Value} \times \text{Liquidation Threshold}}{\text{Total Borrowed Value}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">HealthÂ Factor</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">TotalÂ BorrowedÂ Value</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">CollateralÂ Value</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">LiquidationÂ Threshold</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><strong>ç¤ºä¾‹</strong><br>å‡è®¾ï¼š</p><ul><li>æŠµæŠ¼å“ä»·å€¼ï¼ˆCollateral Valueï¼‰ = $150,000</li><li>æ¸…ç®—é˜ˆå€¼ï¼ˆLiquidation Thresholdï¼‰ = 80% (0.8)</li><li>å€Ÿæ¬¾æ€»é¢ï¼ˆTotal Borrowed Valueï¼‰ = $100,000</li></ul><p>åˆ™å¥åº·å› å­ä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>HealthÂ Factor</mtext><mo>=</mo><mfrac><mrow><mn>150</mn><mtext>â€‰</mtext><mn>000</mn><mo>Ã—</mo><mn>0.8</mn></mrow><mrow><mn>100</mn><mtext>â€‰</mtext><mn>000</mn></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>120</mn><mtext>â€‰</mtext><mn>000</mn></mrow><mrow><mn>100</mn><mtext>â€‰</mtext><mn>000</mn></mrow></mfrac><mo>=</mo><mn>1.2</mn></mrow><annotation encoding="application/x-tex">\text{Health Factor} = \frac{150\,000 \times 0.8}{100\,000} = \frac{120\,000}{100\,000} = 1.2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">HealthÂ Factor</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">100</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">150</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">100</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">120</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.2</span></span></span></span></span></p><p>è‹¥å¥åº·å› å­ä½äº 1ï¼Œåˆ™è¡¨æ˜å€Ÿæ¬¾äººé£é™©è¾ƒé«˜ï¼Œå¯èƒ½è§¦å‘æ¸…ç®—ã€‚</p><hr><h2 id="4-æ—¶é—´åˆ©ç‡è½¬æ¢">4. æ—¶é—´åˆ©ç‡è½¬æ¢</h2><p>å½“åˆ©ç‡ä»¥å¹´åŒ–å½¢å¼ç»™å‡ºæ—¶ï¼Œéœ€è½¬æ¢ä¸ºæ¯ç§’åˆ©ç‡ï¼Œå…¬å¼ä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>r</mi><mtext>perÂ second</mtext></msub><mo>=</mo><mfrac><msub><mi>r</mi><mtext>annual</mtext></msub><mrow><mn>365</mn><mo>Ã—</mo><mn>24</mn><mo>Ã—</mo><mn>3600</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">r_{\text{per second}} = \frac{r_{\text{annual}}}{365 \times 24 \times 3600}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">perÂ second</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8769em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">365</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">24</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">3600</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">annual</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><strong>ç¤ºä¾‹</strong><br>å¯¹äºå¹´åŒ–åˆ©ç‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mtext>annual</mtext></msub><mo>=</mo><mn>5</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">r_{\text{annual}} = 5\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">annual</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">5%</span></span></span></span>ï¼ˆå³ 0.05ï¼‰ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>r</mi><mtext>perÂ second</mtext></msub><mo>=</mo><mfrac><mn>0.05</mn><mrow><mn>31</mn><mtext>â€‰</mtext><mn>536</mn><mtext>â€‰</mtext><mn>000</mn></mrow></mfrac><mo>â‰ˆ</mo><mn>1.585</mn><mo>Ã—</mo><msup><mn>10</mn><mrow><mo>âˆ’</mo><mn>9</mn></mrow></msup></mrow><annotation encoding="application/x-tex">r_{\text{per second}} = \frac{0.05}{31\,536\,000} \approx 1.585 \times 10^{-9}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">perÂ second</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">31</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">536</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.05</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.585</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span></span></span></p><hr><h2 id="5-æ¸…ç®—ç›¸å…³è®¡ç®—">5. æ¸…ç®—ç›¸å…³è®¡ç®—</h2><p>å½“å€Ÿæ¬¾äººå¥åº·å› å­ä½äºå®‰å…¨é˜ˆå€¼æ—¶ï¼Œæ¸…ç®—è€…å¯ä»¥å¿è¿˜éƒ¨åˆ†å€ºåŠ¡å¹¶è·å¾—ç›¸åº”æŠ˜æ‰£çš„æŠµæŠ¼å“ã€‚æ¸…ç®—å¥–åŠ±çš„è®¡ç®—å…¬å¼ä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>CollateralÂ toÂ Receive</mtext><mo>=</mo><mtext>DebtÂ Covered</mtext><mo>Ã—</mo><mfrac><mtext>OracleÂ PriceÂ ofÂ DebtÂ Asset</mtext><mtext>OracleÂ PriceÂ ofÂ CollateralÂ Asset</mtext></mfrac><mo>Ã—</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mtext>LiquidationÂ Bonus</mtext><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Collateral to Receive} = \text{Debt Covered} \times \frac{\text{Oracle Price of Debt Asset}}{\text{Oracle Price of Collateral Asset}} \times \left(1 + \text{Liquidation Bonus}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">CollateralÂ toÂ Receive</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">DebtÂ Covered</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">OracleÂ PriceÂ ofÂ CollateralÂ Asset</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">OracleÂ PriceÂ ofÂ DebtÂ Asset</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">LiquidationÂ Bonus</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p><strong>ç¤ºä¾‹</strong><br>å‡è®¾ï¼š</p><ul><li>æ¸…ç®—è€…å¿è¿˜çš„å€ºåŠ¡é‡‘é¢ï¼ˆDebt Coveredï¼‰ = $10,000</li><li>å€Ÿæ¬¾èµ„äº§çš„é¢„è¨€æœºä»·æ ¼ = $1/å•ä½</li><li>æŠµæŠ¼å“çš„é¢„è¨€æœºä»·æ ¼ = $0.5/å•ä½</li><li>æ¸…ç®—å¥–åŠ±ï¼ˆLiquidation Bonusï¼‰ = 5% (0.05)</li></ul><p>è®¡ç®—è·å¾—çš„æŠµæŠ¼å“æ•°é‡ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>CollateralÂ toÂ Receive</mtext><mo>=</mo><mn>10</mn><mtext>â€‰</mtext><mn>000</mn><mo>Ã—</mo><mfrac><mn>1</mn><mn>0.5</mn></mfrac><mo>Ã—</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>0.05</mn><mo stretchy="false">)</mo><mo>=</mo><mn>10</mn><mtext>â€‰</mtext><mn>000</mn><mo>Ã—</mo><mn>2</mn><mo>Ã—</mo><mn>1.05</mn><mo>=</mo><mn>21</mn><mtext>â€‰</mtext><mn>000</mn><mspace width="1em"><mtext>å•ä½</mtext></mspace></mrow><annotation encoding="application/x-tex">\text{Collateral to Receive} = 10\,000 \times \frac{1}{0.5} \times (1 + 0.05) = 10\,000 \times 2 \times 1.05 = 21\,000 \quad \text{å•ä½}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">CollateralÂ toÂ Receive</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.5</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.05</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.05</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">21</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord cjk_fallback">å•ä½</span></span></span></span></span></span></p><blockquote><p><strong>è¯´æ˜</strong>ï¼šåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæ¸…ç®—è€…å¿è¿˜ $10,000 çš„å€ºåŠ¡ï¼Œå¯ä»¥è·å¾—ä»·å€¼ $10,500 çš„æŠµæŠ¼å“ï¼ˆå¦‚æœæ¯å•ä½æŠµæŠ¼å“ä»·å€¼ $0.5ï¼Œåˆ™æ•°é‡ä¸º 21,000 ä¸ªå•ä½ï¼‰ï¼Œå®ç°é¢å¤–çš„ 5% å¥–åŠ±ã€‚</p></blockquote><hr><h1>æ€»ç»“</h1><p>é€šè¿‡ä¸Šè¿°å…¬å¼å’Œç¤ºä¾‹ï¼Œå¯ä»¥çœ‹å‡º Aave åè®®å¦‚ä½•åˆ©ç”¨ç²¾ç¡®çš„æ•°å­¦è®¡ç®—å®ç°ä»¥ä¸‹å…³é”®åŠŸèƒ½ï¼š</p><ul><li><strong>åˆ©ç‡è®¡ç®—</strong>ï¼šæ ¹æ®å‚¨å¤‡åˆ©ç”¨ç‡åŠé¢„è®¾å‚æ•°åˆ†æ®µè®¡ç®—å¯å˜ä¸ç¨³å®šå€Ÿæ¬¾åˆ©ç‡ï¼Œå¹¶è¿›ä¸€æ­¥æ¨å¯¼å­˜æ¬¾åˆ©ç‡ã€‚</li><li><strong>åˆ©æ¯ç´¯ç§¯</strong>ï¼šåˆ©ç”¨æµåŠ¨æ€§æŒ‡æ•°ä¸å¯å˜å€Ÿæ¬¾æŒ‡æ•°æŒ‰æ—¶é—´ç´¯ç§¯åˆ©æ¯ï¼Œç¡®ä¿ç”¨æˆ·å­˜æ¬¾å’Œå€Ÿæ¬¾çŠ¶æ€å®æ—¶æ›´æ–°ã€‚</li><li><strong>é£é™©æ§åˆ¶</strong>ï¼šé€šè¿‡å¥åº·å› å­ç›‘æ§å€Ÿæ¬¾äººé£é™©ï¼Œå½“å¥åº·å› å­ä½äº 1 æ—¶è§¦å‘æ¸…ç®—æœºåˆ¶ï¼Œä¿æŠ¤ç³»ç»Ÿå®‰å…¨ã€‚</li><li><strong>æ¸…ç®—æ¿€åŠ±</strong>ï¼šåœ¨æ¸…ç®—è¿‡ç¨‹ä¸­ï¼Œæ¸…ç®—å¥–åŠ±æœºåˆ¶ç¡®ä¿æ¸…ç®—è€…èƒ½ä»¥æŠ˜æ‰£ä»·è·å¾—æŠµæŠ¼å“ï¼Œä»è€Œæ¿€åŠ±å¸‚åœºè¡Œä¸ºä¿æŒæ•´ä½“ç³»ç»Ÿå¥åº·ã€‚</li></ul><p>ä»¥ä¸Šè¯¦ç»†å…¬å¼åŠå…·ä½“æ•°å€¼ç¤ºä¾‹ä¸ºç†è§£ Aave å€Ÿè´·æ ¸å¿ƒè®¡ç®—é€»è¾‘æä¾›äº†ç›´è§‚å‚è€ƒã€‚æ›´å¤šç»†èŠ‚å’Œå®ç°ä»£ç è¯·å‚è€ƒ <a href="https://github.com/aave/aave-v3-core/tree/master">Aave v3 Core GitHub ä»“åº“</a> ä¸­çš„æºç åŠç›¸å…³æ•°å­¦åº“ï¼ˆå¦‚ <a href="https://github.com/aave/aave-v3-core/blob/master/contracts/protocol/libraries/math/WadRayMath.sol">WadRayMath.sol</a>ï¼‰ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨ VS Code å¼€å‘ Salesforce çš„å®Œæ•´æŒ‡å—</title>
    <link href="/2024/03/12/salesforce1/"/>
    <url>/2024/03/12/salesforce1/</url>
    
    <content type="html"><![CDATA[<p>æ–¹æ³• 3ï¼šæˆäºˆç”¨æˆ·è®¿é—®æƒé™ åœ¨ Salesforce Setupï¼ˆè®¾ç½®ï¼‰æœç´¢ Profilesæ‰¾åˆ° JWT è®¤è¯ä½¿ç”¨çš„ SalesforceUsername æ‰€å±çš„ Profile åœ¨ Profile è®¾ç½®ä¸­ç¡®ä¿ "API Enabled" é€‰é¡¹å·²å¯ç”¨ åœ¨ "Connected App Access" éƒ¨åˆ†ï¼Œå‹¾é€‰ä½ çš„Connected App ä¿å­˜ æ›´æ”¹</p><h1 id="add-multi-users">add multi users</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;User&gt; users = <span class="hljs-keyword">new</span> <span class="hljs-title class_">List</span>&lt;User&gt;();<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">Integer</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>    users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<br>        FirstName = <span class="hljs-string">&#x27;Test&#x27;</span>,<br>        LastName = <span class="hljs-string">&#x27;User&#x27;</span> + i,<br>        Alias = <span class="hljs-string">&#x27;test&#x27;</span> + i,<br>        Email = <span class="hljs-string">&#x27;testuser&#x27;</span> + i + <span class="hljs-string">&#x27;@example.com&#x27;</span>,<br>        Username = <span class="hljs-string">&#x27;testuser&#x27;</span> + i + <span class="hljs-string">&#x27;@example.com.sandbox&#x27;</span>,<br>        TimeZoneSidKey = <span class="hljs-string">&#x27;Asia/Tokyo&#x27;</span>,<br>        LocaleSidKey = <span class="hljs-string">&#x27;ja_JP&#x27;</span>,<br>        EmailEncodingKey = <span class="hljs-string">&#x27;ISO-2022-JP&#x27;</span>,<br>        LanguageLocaleKey = <span class="hljs-string">&#x27;ja&#x27;</span>,<br>        ProfileId = [SELECT Id FROM Profile <span class="hljs-type">WHERE</span> <span class="hljs-variable">Name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;Standard User&#x27;</span> LIMIT <span class="hljs-number">1</span>].Id<br>    ));<br>&#125;<br><br>insert users;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>salesforce</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>uniswap</title>
    <link href="/2024/02/05/uniswap/"/>
    <url>/2024/02/05/uniswap/</url>
    
    <content type="html"><![CDATA[<p><img src="/2024/02/05/uniswap/2025-02-05-11-17-40.png"></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> copy <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;copy-to-clipboard&#x27;</span><br><span class="hljs-keyword">import</span> &#123; useCallback, useEffect, useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useCopyClipboard</span>(<span class="hljs-params">timeout = <span class="hljs-number">500</span></span>): [<span class="hljs-built_in">boolean</span>, <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">toCopy</span>: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>] &#123;<br>  <span class="hljs-keyword">const</span> [isCopied, setIsCopied] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>)<br><br>  <span class="hljs-keyword">const</span> staticCopy = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span></span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> didCopy = <span class="hljs-title function_">copy</span>(text)<br>    <span class="hljs-title function_">setIsCopied</span>(didCopy)<br>  &#125;, [])<br><br>  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (isCopied) &#123;<br>      <span class="hljs-keyword">const</span> hide = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-title function_">setIsCopied</span>(<span class="hljs-literal">false</span>)<br>      &#125;, timeout)<br><br>      <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-built_in">clearTimeout</span>(hide)<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span><br>  &#125;, [isCopied, setIsCopied, timeout])<br><br>  <span class="hljs-keyword">return</span> [isCopied, staticCopy]<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> copy <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;copy-to-clipboard&#x27;</span><br><span class="hljs-keyword">import</span> &#123; useCallback, useEffect, useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useCopyClipboard</span>(<span class="hljs-params">timeout = <span class="hljs-number">500</span></span>): [<span class="hljs-built_in">boolean</span>, <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">toCopy</span>: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>] &#123;<br>  <span class="hljs-keyword">const</span> [isCopied, setIsCopied] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>)<br><br>  <span class="hljs-keyword">const</span> staticCopy = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span></span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> didCopy = <span class="hljs-title function_">copy</span>(text)<br>    <span class="hljs-title function_">setIsCopied</span>(didCopy)<br>  &#125;, [])<br><br>  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (isCopied) &#123;<br>      <span class="hljs-keyword">const</span> hide = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-title function_">setIsCopied</span>(<span class="hljs-literal">false</span>)<br>      &#125;, timeout)<br><br>      <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-built_in">clearTimeout</span>(hide)<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span><br>  &#125;, [isCopied, setIsCopied, timeout])<br><br>  <span class="hljs-keyword">return</span> [isCopied, staticCopy]<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>web3</tag>
      
      <tag>defi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dify base</title>
    <link href="/2024/02/05/dify-base/"/>
    <url>/2024/02/05/dify-base/</url>
    
    <content type="html"><![CDATA[<h1 id="models-erdiagram">models ERDiagram</h1><pre><code class=" mermaid">erDiagram    App &#123;        string id PK        string tenant_id FK        string name        string icon        string icon_background        string description        string mode        string status        boolean is_demo        boolean is_public        boolean is_pinned        string api_base_url        string api_key        string site_url        string copyright        string privacy_policy        string custom_disclaimer        string language        datetime created_at        datetime updated_at    &#125;        AppModelConfig &#123;        string id PK        string app_id FK        string opening_statement        string suggested_questions        string suggested_questions_after_answer        string speech_to_text        string text_to_speech        string more_like_this        string sensitive_word_avoidance        string external_data_tools        string model        string user_input_form        string dataset_query_variable        string pre_prompt        string agent_mode        string retriever_resource        string prompt_type        string chat_prompt_config        string completion_prompt_config        string dataset_configs        string file_upload    &#125;        RecommendedApp &#123;        string id PK        string app_id FK        json description        string copyright        string privacy_policy        string custom_disclaimer        string category        int position        boolean is_listed        int install_count        string language        datetime created_at        datetime updated_at    &#125;        InstalledApp &#123;        string id PK        string tenant_id FK        string app_id FK        string app_owner_tenant_id        int position        boolean is_pinned        datetime last_used_at        datetime created_at    &#125;        Conversation &#123;        string id PK        string app_id FK        string app_model_config_id FK        string model_provider        string override_model_configs        string model_id        string mode        string name        string summary        json inputs        string introduction        string system_instruction        int system_instruction_tokens        string status        string invoke_from        string from_source        string from_end_user_id FK        string from_account_id FK        datetime read_at        string read_account_id        int dialogue_count        datetime created_at        datetime updated_at        boolean is_deleted    &#125;        Message &#123;        string id PK        string app_id FK        string model_provider        string model_id        string override_model_configs        string conversation_id FK        json inputs        string query        json message        int message_tokens        decimal message_unit_price        decimal message_price_unit        string answer        int answer_tokens        decimal answer_unit_price        decimal answer_price_unit        string parent_message_id        float provider_response_latency        decimal total_price        string currency        string status        string error        string message_metadata        string invoke_from        string from_source        string from_end_user_id FK        string from_account_id FK        datetime created_at        datetime updated_at        boolean agent_based        string workflow_run_id FK    &#125;        MessageFeedback &#123;        string id PK        string app_id FK        string conversation_id FK        string message_id FK        string rating        string content        string from_source        string from_end_user_id FK        string from_account_id FK        datetime created_at        datetime updated_at    &#125;        MessageFile &#123;        string id PK        string message_id FK        string type        string transfer_method        string url        string belongs_to        string upload_file_id        string created_by_role        string created_by FK        datetime created_at    &#125;        MessageAnnotation &#123;        string id PK        string app_id FK        string conversation_id FK        string message_id FK        string question        string content        int hit_count        string account_id FK        datetime created_at        datetime updated_at    &#125;        App ||--o&#123; AppModelConfig : &quot;has&quot;    App ||--o&#123; RecommendedApp : &quot;is recommended as&quot;    App ||--o&#123; InstalledApp : &quot;is installed as&quot;    App ||--o&#123; Conversation : &quot;has&quot;    App ||--o&#123; Message : &quot;contains&quot;    App ||--o&#123; MessageFeedback : &quot;receives&quot;    App ||--o&#123; MessageAnnotation : &quot;has&quot;        AppModelConfig ||--o&#123; Conversation : &quot;configures&quot;        Conversation ||--o&#123; Message : &quot;contains&quot;    Conversation ||--o&#123; MessageAnnotation : &quot;has&quot;        Message ||--o&#123; MessageFeedback : &quot;receives&quot;    Message ||--o&#123; MessageFile : &quot;has&quot;    Message ||--o&#123; MessageAnnotation : &quot;has&quot;</code></pre><pre><code class=" mermaid">erDiagram    App &#123;        string id PK        string name        string description        string mode        boolean is_public        boolean is_demo        string status    &#125;        RecommendedApp &#123;        string id PK        string app_id FK        json description        string copyright        string privacy_policy        string category        int position        boolean is_listed        int install_count        string language    &#125;        Dataset &#123;        string id PK        string tenant_id FK        string name        string description        string provider        string permission        string data_source_type        string indexing_technique        string index_struct        string created_by FK        datetime created_at        string updated_by FK        datetime updated_at        string embedding_model        string embedding_model_provider        string collection_binding_id        json retrieval_model    &#125;        DatasetProcessRule &#123;        string id PK        string dataset_id FK        string mode        string rules        string created_by FK        datetime created_at    &#125;        Document &#123;        string id PK        string tenant_id FK        string dataset_id FK        int position        string data_source_type        string data_source_info        string dataset_process_rule_id FK        string batch        string name        string created_from        string created_by FK        datetime created_at        string indexing_status        boolean enabled        boolean archived        int word_count        int tokens        string doc_type        json doc_metadata        string doc_form        string doc_language    &#125;        DocumentSegment &#123;        string id PK        string tenant_id FK        string dataset_id FK        string document_id FK        int position        string content        string answer        int word_count        int tokens        string status        int hit_count        string index_node_id        string index_node_hash        boolean enabled        datetime created_at        datetime updated_at    &#125;        DatasetKeywordTable &#123;        string id PK        string dataset_id FK        string keyword        string created_by FK        datetime created_at    &#125;        AppDatasetJoin &#123;        string id PK        string app_id FK        string dataset_id FK        datetime created_at    &#125;        App ||--o&#123; RecommendedApp : &quot;is recommended as&quot;    App ||--o&#123; AppDatasetJoin : &quot;uses&quot;    Dataset ||--o&#123; AppDatasetJoin : &quot;is used by&quot;    Dataset ||--o&#123; Document : &quot;contains&quot;    Dataset ||--o&#123; DocumentSegment : &quot;has segments&quot;    Dataset ||--o&#123; DatasetProcessRule : &quot;has rules&quot;    Dataset ||--o&#123; DatasetKeywordTable : &quot;has keywords&quot;    Document ||--o&#123; DocumentSegment : &quot;is divided into&quot;</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>dify</tag>
      
      <tag>ai</tag>
      
      <tag>ai-agent</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
